"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4760],{18726:function(e,t,n){n.d(t,{w:function(){return s},z:function(){return a}});var r=n(72253),i=n(47702),o=n(85893),a=function(e){var t=e.buttonType,n=e.className,a=(0,i._)(e,["buttonType","className"]),s="";switch(t){default:case"primary":s="bg-button hover:bg-[#a0a367] active:bg-[#93965b] ";break;case"secondary":break;case"destructive":s="bg-[#c44444] hover:[#c4444411] active:[#c44444] text-gray-50"}return(0,o.jsx)("button",(0,r._)({className:"leading-tight rounded border border-black px-2 text-sm ".concat(s," ").concat(n),style:{height:40}},a))},s=function(e){var t=e.type,n=e.buttonType,r=e.className,i="";switch(t){default:case"primary":i="bg-blue-700 hover:bg-blue-500 active:bg-blue-300";break;case"secondary":i="bg-gray-700 hover:bg-gray-500 active:bg-gray-300";break;case"destructive":i="bg-red-700 hover:bg-red-500 active:bg-red-300"}return(0,o.jsx)("button",{className:"text-white rounded px-2 py-1 ".concat(i," ").concat(r||""),onClick:e.onClick,type:n,children:e.children})}},31318:function(e,t,n){n.d(t,{z:function(){return h}});var r=n(24043),i=n(248),o=n(85893),a=n(60181),s=n(67294),c=n(94760),l=n(78726),d=n(53107),u=n(58199),h=function(e){var t=e.items,n=void 0===t?[]:t,m=e.width,f=e.height,v=e.onItemsChanged,x=e.filter,p=e.singleItem,y=e.enabled,g=e.isFloating,b=e.expandable,w=(0,s.useContext)(u.P),j=w.hand,k=w.setHand,_=w.hoveredCell,I=w.setHoverableCells,C=(0,r._)((0,s.useState)(!1),2),N=C[0],S=C[1],A=(0,s.useId)(),P=(0,s.useContext)(c.Q).scale,L=j&&_===A;(0,s.useEffect)(function(){return I(function(e){return(0,i._)(e).concat([A])}),function(){I(function(e){return e.filter(function(e){return e!==A})})}},[]);var E=(0,s.useCallback)(function(e){A===e.detail&&D()},[A,j]);(0,s.useEffect)(function(){return document.addEventListener("celldrop",E),function(){document.removeEventListener("celldrop",E)}});var z=function(){n&&n.length>0&&(k(n[n.length-1]),v(n.slice(0,n.length-1)))},D=function(){j&&(!x||x(j))&&(p?(n&&n.length>0&&!(0,l.T)()?k(n[n.length-1]):k(void 0),v([j])):(k(void 0),v((0,i._)(n).concat([j]))))},O=function(){b&&!g&&n.length>1?S(!N):j?D():z()},R=function(){b&&!g&&n.length>1||z()},T=n.map(function(e,t){var r=(0,d.s)(e),i=.4*r.width,a=(m-r.width*n.length+i*(n.length-1))/2+r.width*t-i*t,s=(f-r.height)/2;return(0,o.jsx)("div",{style:{position:"absolute",left:a*P,top:s*P},children:(0,o.jsx)(d.q,{item:e})},"itemPanel-".concat(e.id,"-").concat(t))}),B=void 0!==j||void 0!==n&&n.length>0,H=y?"":"bg-[#00000077]";return b?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{id:A,onTouchStart:R,onClick:O,className:"select-none touch-none flex flex-row ".concat(H," items-center justify-center"),style:{cursor:B?"pointer":"default",width:m*P,height:f*P,zIndex:L?1:0,outline:L?"4px solid #e8dc38":void 0,WebkitTapHighlightColor:"transparent"},children:n.length>0&&(0,o.jsx)(d.q,{item:n[0]})}),N&&(0,o.jsxs)("div",{className:"flex flex-col absolute top-0 left-0 z-10 bg-black gap-1 p-1 -m-1",children:[(0,o.jsx)("div",{className:"flex items-center justify-center cursor-pointer bg-panel",style:{backgroundImage:'url("/cell_bg.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:70*P,height:32*P},onClick:function(){return S(!1)},children:(0,o.jsx)(a.Z,{sx:{fontSize:48}})}),n.map(function(e,t){return(0,o.jsx)("div",{className:"relative",style:{backgroundImage:'url("/cell_bg.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},children:(0,o.jsx)(h,{width:m,height:f,items:[e],singleItem:!0,enabled:!0,onItemsChanged:function(e){if(0===e.length){var r=(0,i._)(n);r.splice(t,1),v(r)}else{var o=(0,i._)(n);o.splice(t,1,e[0]),v(o)}},isFloating:!0})},"itemPanel-".concat(e.id,"-").concat(t))}),(0,o.jsx)("div",{className:"flex items-center justify-center cursor-pointer",style:{width:m*P,height:f*P,backgroundImage:'url("/cell_bg.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},children:(0,o.jsx)(h,{width:m,height:f,items:[],singleItem:!0,enabled:!0,onItemsChanged:function(e){if(0===e.length){alert("Cannot drop item here");return}v((0,i._)(n).concat([e[0]]))},isFloating:!0})})]})]}):(0,o.jsx)("div",{id:A,onTouchStart:R,onClick:O,className:"select-none touch-none flex flex-row ".concat(H),style:{cursor:B?"pointer":"default",width:m*P,height:f*P,zIndex:L?1:0,outline:L?"4px solid #e8dc38":void 0,WebkitTapHighlightColor:"transparent"},children:T})}},97169:function(e,t,n){n.d(t,{O:function(){return a},u:function(){return s}});var r=n(85893),i=n(67294),o=n(1604),a=function(e){var t=e.children;return(0,r.jsx)(s,{onDismiss:function(){},fullscreen:!0,children:t})},s=function(e){var t=e.children,n=e.onDismiss,a=e.noScroll,s=e.fullscreen,c=(0,i.useRef)(null);return(0,i.useEffect)(function(){return a&&(document.body.style.position="fixed",document.body.style.top="-".concat(window.scrollY,"px")),function(){if(a){var e=document.body.style.top;document.body.style.position="",document.body.style.top="",window.scrollTo(0,-1*parseInt(e||"0"))}}}),(0,r.jsx)(o.h,{children:(0,r.jsx)("div",{ref:c,className:"absolute top-0 left-0 h-full w-full flex flex-row items-center justify-center bg-[#00000099] ".concat(s?"":"lg:px-16 lg:py-8 "),style:{zIndex:10},onClick:function(e){e.target===c.current&&n()},children:t})})}},1604:function(e,t,n){n.d(t,{h:function(){return c}});var r=n(48564),i=n(18007),o=n(53304),a=n(67294),s=n(73935),c=function(e){(0,i._)(n,e);var t=(0,o._)(n);function n(e){(0,r._)(this,n),i=t.call(this,e);var i,o=document.getElementById("modal-container");return null===o&&(o=document.createElement("div"),document.body.appendChild(o)),i.modalContainer=o,i}return n.prototype.render=function(){return s.createPortal(this.props.children,this.modalContainer)},n}(a.PureComponent)},19592:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(72253),i=n(14932);function o(e){return{saves:e.saves.map(function(e){return(0,i._)((0,r._)({},e),{inventory:(0,i._)((0,r._)({},e.inventory),{vest:e.inventory.vest&&[e.inventory.vest],pouch:e.inventory.pouch&&[e.inventory.pouch],backpack:e.inventory.backpack&&[e.inventory.backpack],patch:e.inventory.patch&&[e.inventory.patch],helmet:e.inventory.helmet&&[e.inventory.helmet],armour:e.inventory.armour&&[e.inventory.armour],clothes:e.inventory.clothes&&[e.inventory.clothes],eyes:e.inventory.eyes&&[e.inventory.eyes],mask:e.inventory.mask&&[e.inventory.mask],radio:e.inventory.radio&&[e.inventory.radio]})})}),version:3}}},73842:function(e,t,n){n.d(t,{XP:function(){return p},IB:function(){return g},fF:function(){return b}});var r,i,o,a,s,c=n(11010),l=n(70655),d=n(14571),u=n(72253),h=n(14932),m=n(19592),f=n(31900),v=(r=(0,c._)(function(e,t){return(0,l.Jh)(this,function(n){switch(n.label){case 0:return[4,d.u.get({key:"saves_v".concat(t)})];case 1:if(null!==n.sent().value)return[3,3];return[4,d.u.set({key:"saves_v".concat(t),value:JSON.stringify(e)})];case 2:n.sent(),n.label=3;case 3:return[2]}})}),function(e,t){return r.apply(this,arguments)}),x=(i=(0,c._)(function(){var e,t,n,r,i,o,a,s;return(0,l.Jh)(this,function(c){switch(c.label){case 0:e=!1,t=!0,n=!1,r=void 0,c.label=1;case 1:c.trys.push([1,8,9,10]),i=p.toReversed()[Symbol.iterator](),c.label=2;case 2:if(t=(o=i.next()).done)return[3,7];if(a=o.value,!e)return[3,4];return[4,d.u.remove({key:"saves_v".concat(a.from)})];case 3:return c.sent(),[3,6];case 4:return[4,d.u.get({key:"saves_v".concat(a.from)})];case 5:null!==c.sent().value&&(e=!0),c.label=6;case 6:return t=!0,[3,2];case 7:return[3,10];case 8:return s=c.sent(),n=!0,r=s,[3,10];case 9:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 10:return[2]}})}),function(){return i.apply(this,arguments)}),p=[{from:1,to:2,migrate:function(e){return{saves:e.map(function(e){return(0,h._)((0,u._)({},e),{inventory:(0,h._)((0,u._)({},e.inventory),{vest:e.inventory.vest.item,pouch:e.inventory.pouch.item,backpack:e.inventory.backpack.item,vestCells:e.inventory.vest.cells.flat().map(function(e){return e.items}),pouchCells:e.inventory.pouch.cells.flat().map(function(e){return e.items}),backpackCells:e.inventory.backpack.cells.flat().map(function(e){return e.items}),pockets:e.inventory.pockets.map(function(e){return e.items})})})}),version:2}}},{from:2,to:3,migrate:m.Z},{from:3,to:4,migrate:function(e){return{saves:e.saves.map(function(e){return(0,h._)((0,u._)({},e),{model:e.model?(0,h._)((0,u._)({},e.model),{itemsOrder:e.model.itemsOrder.flatMap(function(e){return"item"===e?["hands","body"]:[e]})}):f.CS})}),version:4}}},{from:4,to:5,migrate:function(e){return{saves:e.saves.map(function(e){return(0,h._)((0,u._)({},e),{model:e.model?(0,h._)((0,u._)({},e.model),{itemsOrder:e.model.itemsOrder.flatMap(function(e){return"hands"===e?[f.n6.RightHand,f.n6.LeftHand,f.n6.Weapon]:[e]}),bodyParts:f.CS.bodyParts}):f.CS})}),version:5}}},{from:5,to:6,migrate:function(e){return{saves:e.saves.map(function(e){if(void 0===e.model)return(0,h._)((0,u._)({},e),{model:f.CS});var t=e.model.itemsOrder;if(!t.includes(f.n6.Head)){var n=t.indexOf(f.n6.Body);t.splice(n,0,f.n6.Head)}var r=e.model.bodyParts;return r.some(function(e){return e.layer===f.n6.Head})||r.push({layer:f.n6.Head,rotation:0,scale:1,position:{x:0,y:0},isMirrored:e.model.flipHead}),(0,h._)((0,u._)({},e),{model:(0,h._)((0,u._)({},e.model),{itemsOrder:t,bodyParts:r})})}),version:6}}},{from:6,to:7,migrate:function(e){return{saves:e.saves.map(function(e){var t=e.model.itemsOrder.reduce(function(e,t){return e.includes(t)||e.push(t),e},[]),n=e.model.bodyParts.reduce(function(e,t){return e.some(function(e){return e.layer===t.layer})||e.push(t),e},[]);return(0,h._)((0,u._)({},e),{model:(0,h._)((0,u._)({},e.model),{itemsOrder:t,bodyParts:n})})}),version:7}}}],y=(o=(0,c._)(function(e){var t,n;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(t=e.version||1,!(n=p.find(function(e){return e.from===t})))return[3,2];return[4,v(e,n.from)];case 1:return r.sent(),[2,y(n.migrate(e))];case 2:return[2,e]}})}),function(e){return o.apply(this,arguments)}),g=(a=(0,c._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,d.u.get({key:"saves"})];case 1:if(!(e=t.sent()).value)return[3,4];return[4,x()];case 2:return t.sent(),[4,y(JSON.parse(e.value))];case 3:return[2,t.sent().saves];case 4:return[2,[]]}})}),function(){return a.apply(this,arguments)}),b=(s=(0,c._)(function(e){var t;return(0,l.Jh)(this,function(n){switch(n.label){case 0:return t={saves:e,version:p.last().to},[4,d.u.set({key:"saves",value:JSON.stringify(t)})];case 1:return n.sent(),[2]}})}),function(e){return s.apply(this,arguments)})},58199:function(e,t,n){n.d(t,{P:function(){return a},m:function(){return s}});var r=n(24043),i=n(85893),o=n(67294),a=o.createContext({hoverableCells:[],setHoverableCells:function(e){},hoveredCell:void 0,setHoveredCell:function(e){},hand:void 0,setHand:function(e){}}),s=function(e){var t=e.children,n=(0,r._)((0,o.useState)(),2),s=n[0],c=n[1],l=(0,r._)((0,o.useState)(),2),d=l[0],u=l[1],h=(0,r._)((0,o.useState)([]),2),m=h[0],f=h[1],v=(0,o.useCallback)(function(e){if(void 0!==s){var t=e.clientX,n=e.clientY,r=document.elementsFromPoint(t,n).find(function(e){return m.includes(e.id)});u(null==r?void 0:r.id)}},[m,s]);return(0,o.useEffect)(function(){return window.addEventListener("pointerdown",v),window.addEventListener("pointermove",v),function(){window.removeEventListener("pointerdown",v),window.removeEventListener("pointermove",v)}},[v]),(0,i.jsx)(a.Provider,{value:{hand:s,setHand:c,hoveredCell:d,setHoveredCell:u,hoverableCells:m,setHoverableCells:f},children:t})}},43537:function(e,t,n){n.d(t,{OE:function(){return c},Yr:function(){return d},e4:function(){return l}});var r=n(24043),i=n(85893),o=n(11163),a=n(67294),s=n(31900),c=function(e,t){return e.filter(function(e){var n=!0;return t.packs&&e.packId&&(n=n&&t.packs.includes(e.packId)),t.country&&(n=n&&void 0!==e.producer&&e.producer===t.country),n&&(n=void 0===e.deletedAt),n})},l=a.createContext({selectedItemType:void 0,setSelectedItemType:function(e){},headIndex:0,setHeadIndex:function(e){},filters:{},setFilters:function(e){},model:s.CS,setModel:function(e){}}),d=function(e){var t=e.children,n=(0,r._)((0,a.useState)(0),2),c=n[0],d=n[1],u=(0,r._)((0,a.useState)(s.CS),2),h=u[0],m=u[1],f=(0,r._)((0,a.useState)(),2),v=f[0],x=f[1],p=(0,o.useRouter)(),y=(0,r._)((0,a.useState)({}),2),g=y[0],b=y[1];return(0,a.useEffect)(function(){if(p.isReady){var e=p.query.pack,t=void 0;e&&(t="string"==typeof e?[e]:e),b({packs:t})}},[p.isReady,p.query]),(0,i.jsx)(l.Provider,{value:{selectedItemType:v,setSelectedItemType:x,headIndex:c,setHeadIndex:d,filters:g,setFilters:b,model:h,setModel:m},children:t})}},80791:function(e,t,n){n.d(t,{P:function(){return a}});var r=n(72253),i=n(85893),o=n(5032),a=function(e){var t=e.value,n=e.onChange,a=e.children,s=e.style,c=(e.sx,e.className);return(0,i.jsx)(o.Z,{MenuProps:{style:{zIndex:1e5}},value:t,style:(0,r._)({height:40},s),className:"bg-button !text-black dark:!text-white ".concat(c),onChange:function(e){return n(e.target.value)},children:a})}},16233:function(e,t,n){n.d(t,{N:function(){return eF},b:function(){return eM}});var r=n(24043),i=n(85893),o=n(27842),a=n(43537),s=n(94478),c=n(43443),l=n(58231),d=n(44178),u=n(67294),h=n(94760),m=n(12796),f=n(72253),v=n(14932),x=n(248),p=n(18726),y=n(97169),g=function(){var e=(0,r._)((0,u.useState)(),2),t=e[0],n=e[1],i=(0,u.useCallback)(function(e){n({x:e.clientX,y:e.clientY})},[]),o=(0,u.useCallback)(function(e){n({x:e.clientX,y:e.clientY})},[]);return(0,u.useEffect)(function(){return window.addEventListener("pointerdown",o),window.addEventListener("pointermove",i),function(){window.removeEventListener("pointerdown",o),window.removeEventListener("pointermove",i)}},[]),t},b=n(77245),w=function(e){e.item;var t=e.children,n=(0,b.k)(),r=g();(0,u.useEffect)(function(){return console.debug("mounted"),function(){console.debug("unmount")}},[]);var o=(null==r?void 0:r.x)||n.x,a=(null==r?void 0:r.y)||n.y;return(0,i.jsx)("div",{id:"hand",style:{left:0,top:0,position:"fixed",pointerEvents:"none",touchAction:"none",transform:"translate(".concat(o,"px, ").concat(a,"px)"),transformOrigin:"left top",zIndex:99999},children:t})},j=n(78726),k=n(77236),_=function(e){var t;return e.zoomScale*((null===(t=e.currentDragAction)||void 0===t?void 0:t.type)==="pinch"?e.currentDragAction.currentPointerDiff/e.currentDragAction.startPointerDiff:1)},I=function(e,t){var n;return e.selectedItemId===t&&(null===(n=e.currentDragAction)||void 0===n?void 0:n.type)==="scale"?e.currentDragAction.current/e.currentDragAction.start:1},C=function(e,t){var n;return e.selectedItemId===t&&(null===(n=e.currentDragAction)||void 0===n?void 0:n.type)==="rotate"?e.currentDragAction.current-e.currentDragAction.start:0},N=function(e,t){var n,r,i={x:e.moveOffset.x,y:e.moveOffset.y};if((null===(n=e.currentDragAction)||void 0===n?void 0:n.type)==="move"&&e.currentDragAction.itemId===t)i.x+=e.currentDragAction.current.x-e.currentDragAction.start.x,i.y+=e.currentDragAction.current.y-e.currentDragAction.start.y;else if((null===(r=e.currentDragAction)||void 0===r?void 0:r.type)==="pinch"){var o=e.currentDragAction.currentPointerDiff/e.currentDragAction.startPointerDiff,a=e.currentDragAction.startCenterPoint.x*(1-o),s=e.currentDragAction.startCenterPoint.y*(1-o),c=e.currentDragAction.currentCenterPoint.x-e.currentDragAction.startCenterPoint.x,l=e.currentDragAction.currentCenterPoint.y-e.currentDragAction.startCenterPoint.y;i.x+=a+c,i.y+=s+l}return i},S=(0,k.oM)({name:"upgradePanel",initialState:{hoveredItemId:void 0,selectedItemId:void 0,attachements:[],itemsOrder:[],bodyParts:[],rect:{left:0,top:0,width:0,height:0},zoomScale:2,moveOffset:{x:0,y:0}},reducers:{hoverItem:function(e,t){e.hoveredItemId=t.payload.itemId},clearHover:function(e){e.hoveredItemId=void 0},itemSelected:function(e,t){e.selectedItemId=t.payload.itemId},itemsOrderChanged:function(e,t){e.itemsOrder=t.payload.newItemsOrder},attachementsLoaded:function(e,t){e.attachements=t.payload.newAttachementsList},bodyPartsLoaded:function(e,t){e.bodyParts=t.payload.newBodyPartsList},attachementPlaced:function(e,t){e.attachements=(0,x._)(e.attachements).concat([t.payload.newAttachement]),e.itemsOrder=[t.payload.newAttachement.id].concat((0,x._)(e.itemsOrder))},bodyPartChanged:function(e,t){e.bodyParts=e.bodyParts.map(function(e){return e.layer===t.payload.bodyPartLayer?(0,v._)((0,f._)({},e),{position:t.payload.position,rotation:t.payload.rotation,isMirrored:t.payload.isMirrored,handType:t.payload.handType,scale:t.payload.scale,weaponModel:t.payload.weaponModel}):e})},attachementPositionChanged:function(e,t){e.attachements=e.attachements.map(function(e){return e.id===t.payload.attachementId?(0,v._)((0,f._)({},e),{position:t.payload.position,rotation:t.payload.rotation,scale:t.payload.scale,isMirrored:t.payload.isMirrored}):e})},attachementDeleted:function(e,t){e.attachements=e.attachements.filter(function(e){return e.id!==t.payload.attachementId}),e.itemsOrder=e.itemsOrder.filter(function(e){return e!==t.payload.attachementId})},currentDragActionChanged:function(e,t){e.currentDragAction=t.payload},rectChanged:function(e,t){e.rect=t.payload.rect},setZoomScale:function(e,t){e.zoomScale=t.payload.zoomScale,e.moveOffset=t.payload.moveOffset}}}),A=S.actions,P=A.hoverItem,L=A.clearHover,E=A.bodyPartsLoaded,z=A.bodyPartChanged,D=A.itemSelected,O=A.itemsOrderChanged,R=A.attachementsLoaded,T=A.attachementPlaced,B=A.attachementPositionChanged,H=A.attachementDeleted,M=A.currentDragActionChanged,F=A.rectChanged,Z=A.setZoomScale,X=function(){var e=(0,r._)((0,u.useReducer)(S.reducer,S.getInitialState()),2);return[e[0],e[1]]},Y="invert(13%) sepia(81%) saturate(2343%) hue-rotate(359deg) brightness(94%) contrast(115%)",U=function(e){var t=e.attachement,n=e.zIndex,r=e.dispatch,o=e.state,a=(0,u.useContext)(h.Q).scale*_(o),s=(t.position.x-t.item.icon.width/2)*a+o.rect.width/2+N(o,t.id).x,c=(t.position.y-t.item.icon.height/2)*a+o.rect.height/2+N(o,t.id).y,l=t.rotation+C(o,t.id),d=t.scale*I(o,t.id),m=t.item.icon.width*a*d,f=t.item.icon.height*a*d,v=Math.max(m,f),x=-v/d+v;s-=x/2,c-=x/2;var p=function(e,t){r(M({type:"move",itemId:t.id,start:{x:e.clientX,y:e.clientY},current:{x:e.clientX,y:e.clientY}}))},y=function(e,t){var n;(null===(n=o.currentDragAction)||void 0===n?void 0:n.type)==="move"&&(r(B({attachementId:t.id,position:{x:t.position.x+(o.currentDragAction.current.x-o.currentDragAction.start.x)/a,y:t.position.y+(o.currentDragAction.current.y-o.currentDragAction.start.y)/a},rotation:t.rotation,scale:t.scale,isMirrored:t.isMirrored})),r(M(void 0)))};return(0,i.jsx)("div",{className:"",style:{position:"absolute",left:s,top:c,zIndex:n,transform:"rotate(".concat(l,"deg)")},onClick:function(e){r(D({itemId:t.id}))},children:(0,i.jsx)("img",{src:t.item.icon.image,alt:"",onPointerDown:function(e){p(e,t)},onPointerUp:function(e){y(e,t)},onContextMenu:function(e){(0,j.T)()||(e.preventDefault(),e.stopPropagation(),r(H({attachementId:t.id})))},draggable:!1,style:{width:m,height:f,minWidth:m,minHeight:f,filter:o.hoveredItemId===t.id?Y:void 0,WebkitTouchCallout:"none",transform:t.isMirrored?"scaleX(-1)":void 0}},"image-".concat(t.id))})},W=n(73955),Q=n.n(W),q=n(31900),J=n(62586),G=n(9137),V=n(83335),K=n(50579),$=function(e){var t,n,r=e.bodyPart,o=e.state,a=e.dispatch,s=(0,u.useContext)(h.Q).scale*_(o),c=(0,q.lf)(r.layer),l=(r.position.x+-74.5+c.x)*s+o.rect.width/2+N(o,r.layer).x,d=(r.position.y+-120.5+c.y)*s+o.rect.height/2+N(o,r.layer).y,m=r.rotation+C(o,r.layer),x=r.scale*I(o,r.layer),p=Math.max(40*s,40*s)+40*s,y=function(e){a(M({type:"move",itemId:r.layer,start:{x:e.clientX,y:e.clientY},current:{x:e.clientX,y:e.clientY}}))},g=function(e){var t;(null===(t=o.currentDragAction)||void 0===t?void 0:t.type)==="move"&&(a(z((0,v._)((0,f._)({bodyPartLayer:r.layer},r),{position:{x:r.position.x+(o.currentDragAction.current.x-o.currentDragAction.start.x)/s,y:r.position.y+(o.currentDragAction.current.y-o.currentDragAction.start.y)/s}}))),a(M(void 0)))},b=(0,u.useRef)(null);return(0,i.jsxs)("div",{className:"absolute pointer-events-none",style:{zIndex:9999,left:l-p/2,top:d-p/2,width:p,height:p,transform:"rotate(".concat(m,"deg)")},children:[(0,i.jsx)("div",{ref:b,className:"absolute border-2 border-red-700 p-4  border-dashed rounded-full",style:{width:p,height:p}}),(0,i.jsx)("div",{onPointerDown:function(e){a(M({type:"rotate",start:et(o,s,e),current:et(o,s,e)}))},className:"absolute bg-itemList rounded-full border-2 border-red-700 border-dashed flex items-center justify-center cursor-grab pointer-events-auto",style:{left:p-20,top:p/2-20,width:40,height:40},children:(0,i.jsx)(V.Z,{})}),(0,i.jsx)("div",{onClick:function(){a(z((0,v._)((0,f._)({bodyPartLayer:r.layer},r),{isMirrored:!r.isMirrored})))},className:"absolute bg-itemList border-2 rounded-full border-red-700 border-dashed flex items-center justify-center cursor-pointer pointer-events-auto",style:{left:-20,top:p/2-20,width:40,height:40},children:(0,i.jsx)(J.Z,{})}),r.layer===q.n6.Weapon&&(0,i.jsx)("div",{onPointerDown:function(e){a(M({type:"scale",start:en(o,s,e),current:en(o,s,e)}))},className:"absolute bg-itemList rounded-full border-2 border-red-700 border-dashed flex items-center justify-center cursor-nesw-resize pointer-events-auto",style:{left:p/2-20,top:-20,width:40,height:40},children:(0,i.jsx)(G.Z,{})}),(0,i.jsx)("div",{className:"absolute rounded-full bg-transparent flex items-center justify-center  cursor-move pointer-events-auto",style:{left:p/2-20,top:p/2-20,width:40,height:40,rotate:"".concat(-m,"deg")},onPointerDown:function(e){y(e)},onPointerUp:function(e){g(e)},children:(0,i.jsx)("div",{className:"flex items-center justify-center  border-2 border-red-700 border-dashed bg-itemList  rounded-full",children:(0,i.jsx)(K.Z,{})})}),(0,i.jsxs)("div",{className:"flex w-full h-full items-center justify-center",style:{transform:"rotate(".concat(-m,"deg)")},children:[(null===(t=o.currentDragAction)||void 0===t?void 0:t.type)==="rotate"&&(0,i.jsxs)("span",{className:"text-white font-bold",style:{textShadow:"0 0 3px black"},children:[m>0?"+":"",Math.round(m),"\xb0"]}),(null===(n=o.currentDragAction)||void 0===n?void 0:n.type)==="scale"&&(0,i.jsxs)("span",{className:"text-white font-bold",style:{textShadow:"0 0 3px black"},children:[x.toFixed(2),"x"]})]})]})},ee=function(e){var t,n,r=e.attachement,o=e.state,a=e.dispatch,s=(0,u.useContext)(h.Q).scale*_(o),c=(r.position.x-r.item.icon.width/2)*s+o.rect.width/2+N(o,r.id).x,l=(r.position.y-r.item.icon.height/2)*s+o.rect.height/2+N(o,r.id).y,d=r.rotation+C(o,r.id),m=r.scale*I(o,r.id),f=Math.max(r.item.icon.width*s*m,r.item.icon.height*s*m)+40*s,v=c+r.item.icon.width*s/2,x=l+r.item.icon.height*s/2,p=function(e){a(B({attachementId:e.id,scale:e.scale,position:e.position,rotation:e.rotation,isMirrored:!e.isMirrored}))};return(0,i.jsxs)("div",{style:{zIndex:9999,position:"absolute",left:v-f/2,top:x-f/2,width:f,height:f,pointerEvents:"none",transform:"rotate(".concat(d,"deg)")},children:[(0,i.jsx)("div",{className:"absolute border-2 border-red-700 p-4 pointer-events-none border-dashed",style:{width:f,height:f}}),(0,i.jsx)("div",{onPointerDown:function(e){a(M({type:"rotate",start:et(o,s,e),current:et(o,s,e)}))},className:"absolute bg-itemList rounded-full border-2 border-red-700 border-dashed flex items-center justify-center",style:{left:f-20,top:f/2-20,width:40,height:40,pointerEvents:"auto"},children:(0,i.jsx)(V.Z,{})}),(0,i.jsx)("div",{onPointerDown:function(e){a(M({type:"scale",start:en(o,s,e),current:en(o,s,e)}))},className:"absolute bg-itemList border-2 border-red-700 border-dashed flex items-center justify-center",style:{left:f-20,top:-20,width:40,height:40,pointerEvents:"auto"},children:(0,i.jsx)(G.Z,{})}),(0,i.jsx)("div",{onClick:function(){return p(r)},className:"absolute bg-itemList border-2 border-red-700 border-dashed flex items-center justify-center",style:{left:f-20,top:f-20,width:40,height:40,pointerEvents:"auto"},children:(0,i.jsx)(J.Z,{})}),(0,i.jsxs)("div",{className:"flex w-full h-full items-center justify-center",style:{transform:"rotate(".concat(-d,"deg)")},children:[(null===(t=o.currentDragAction)||void 0===t?void 0:t.type)==="rotate"&&(0,i.jsxs)("span",{className:"text-white font-bold",style:{textShadow:"0 0 3px black"},children:[d>0?"+":"",Math.round(d),"\xb0"]}),(null===(n=o.currentDragAction)||void 0===n?void 0:n.type)==="scale"&&(0,i.jsxs)("span",{className:"text-white font-bold",style:{textShadow:"0 0 3px black"},children:[m.toFixed(2),"x"]})]})]})},et=function(e,t,n){var r,i,o=e.attachements.find(function(t){return t.id===e.selectedItemId}),a=e.bodyParts.find(function(t){return t.layer===e.selectedItemId});if(o){var s=(o.position.x-o.item.icon.width/2)*t+e.rect.width/2,c=(o.position.y-o.item.icon.height/2)*t+e.rect.height/2;r=s+o.item.icon.width*t/2,i=c+o.item.icon.height*t/2}else{if(!a)return 0;var l=(-74.5+a.position.x)*t+e.rect.width/2,d=(-120.5+a.position.y)*t+e.rect.height/2,u=(0,q.lf)(a.layer);r=l+u.x*t,i=d+u.y*t}var h=n.clientX-e.rect.left;return Math.atan2(n.clientY-e.rect.top-i,h-r)*(180/Math.PI)},en=function(e,t,n){var r,i,o=e.attachements.find(function(t){return t.id===e.selectedItemId}),a=e.bodyParts.find(function(t){return t.layer===e.selectedItemId});if(o){var s=(o.position.x-o.item.icon.width/2)*t+e.rect.width/2,c=(o.position.y-o.item.icon.height/2)*t+e.rect.height/2;r=s+o.item.icon.width*t/2,i=c+o.item.icon.height*t/2}else{if(!a)return 0;var l=(-74.5+a.position.x)*t+e.rect.width/2,d=(-120.5+a.position.y)*t+e.rect.height/2,u=(0,q.lf)(a.layer);r=l+u.x*t,i=d+u.y*t}var h=n.clientX-e.rect.left,m=n.clientY-e.rect.top,f=h-r,v=m-i;return Math.sqrt(f*f+v*v)},er=(0,u.forwardRef)(function(e,t){var n,r=e.state,o=e.dispatch,a=e.children,s=e.hand,c=e.setHand,l=(0,u.useRef)(null);(0,u.useImperativeHandle)(t,function(){return l.current});var d=(0,u.useRef)({}),m=(0,u.useContext)(h.Q).scale*_(r),x=null===(n=l.current)||void 0===n?void 0:n.getBoundingClientRect(),p={left:(null==x?void 0:x.left)||0,top:(null==x?void 0:x.top)||0,width:(null==x?void 0:x.width)||0,height:(null==x?void 0:x.height)||0},y=JSON.stringify(p);(0,u.useEffect)(function(){o(F({rect:JSON.parse(y)}))},[y]);var g=function(e,t){var n=e-p.left,r=t-p.top;return{x:n-p.width/2,y:r-p.height/2}},b=function(){if((null===(e=r.currentDragAction)||void 0===e?void 0:e.type)==="rotate"){var e,t=r.attachements.find(function(e){return e.id===r.selectedItemId});t&&o(B({attachementId:t.id,position:t.position,rotation:t.rotation+r.currentDragAction.current-r.currentDragAction.start,scale:t.scale,isMirrored:t.isMirrored}));var n=r.bodyParts.find(function(e){return e.layer===r.selectedItemId});n&&o(z((0,v._)((0,f._)({bodyPartLayer:n.layer},n),{rotation:n.rotation+r.currentDragAction.current-r.currentDragAction.start}))),o(M(void 0))}},w=function(){if((null===(e=r.currentDragAction)||void 0===e?void 0:e.type)==="scale"){var e,t=r.attachements.find(function(e){return e.id===r.selectedItemId});t&&o(B({attachementId:t.id,scale:t.scale*r.currentDragAction.current/r.currentDragAction.start,position:t.position,rotation:t.rotation,isMirrored:t.isMirrored}));var n=r.bodyParts.find(function(e){return e.layer===r.selectedItemId});n&&o(z((0,v._)((0,f._)({bodyPartLayer:n.layer},n),{scale:n.scale*r.currentDragAction.current/r.currentDragAction.start}))),o(M(void 0))}},k=(0,u.useCallback)(function(e){return e.clientX<=p.left||e.clientX>=p.left+p.width||e.clientY<=p.top||e.clientY>=p.top+p.height},[p]),I=(0,u.useCallback)(function(e){var t,n,i;if(d.current[e.pointerId]=e,2===Object.values(d.current).length){var a,s=d.current[Object.keys(d.current)[0]],c=d.current[Object.keys(d.current)[1]],l=Math.sqrt(Math.pow(s.clientX-c.clientX,2)+Math.pow(s.clientY-c.clientY,2)),u={x:(s.clientX+c.clientX)/2-p.left-p.width/2,y:(s.clientY+c.clientY)/2-p.top-p.height/2};(null===(a=r.currentDragAction)||void 0===a?void 0:a.type)==="pinch"&&o(M((0,v._)((0,f._)({},r.currentDragAction),{currentPointerDiff:l,currentCenterPoint:u})))}(null===(t=r.currentDragAction)||void 0===t?void 0:t.type)!=="move"||k(e)?r.selectedItemId&&(null===(n=r.currentDragAction)||void 0===n?void 0:n.type)==="rotate"?o(M((0,v._)((0,f._)({},r.currentDragAction),{current:et(r,m,e)}))):r.selectedItemId&&(null===(i=r.currentDragAction)||void 0===i?void 0:i.type)==="scale"&&o(M((0,v._)((0,f._)({},r.currentDragAction),{current:en(r,m,e)}))):o(M((0,v._)((0,f._)({},r.currentDragAction),{current:{x:e.clientX,y:e.clientY}})))},[r,k]),C=r.selectedItemId?r.attachements.find(function(e){return e.id===r.selectedItemId}):void 0,S=r.selectedItemId&&r.bodyParts.find(function(e){return e.layer===r.selectedItemId}),A=(0,u.useCallback)(function(e){var t,n;if(2===Object.values(d.current).length){var i,a=d.current[Object.keys(d.current)[0]],u=d.current[Object.keys(d.current)[1]],h=Math.sqrt(Math.pow(a.clientX-u.clientX,2)+Math.pow(a.clientY-u.clientY,2));if((null===(i=r.currentDragAction)||void 0===i?void 0:i.type)==="pinch"){var f=N(r,"any");o(Z({zoomScale:r.zoomScale*h/r.currentDragAction.startPointerDiff,moveOffset:f})),o(M(void 0))}}delete d.current[e.pointerId],(null===(t=r.currentDragAction)||void 0===t?void 0:t.type)==="rotate"&&r.selectedItemId?b():(null===(n=r.currentDragAction)||void 0===n?void 0:n.type)==="scale"&&r.selectedItemId?w():s&&!k(e)?(o(T({newAttachement:{id:Q()(),item:s,position:{x:(g(e.clientX,e.clientY).x-N(r,"any").x)/m,y:(g(e.clientX,e.clientY).y-N(r,"any").y)/m},rotation:0,scale:1,isMirrored:!1}})),c(void 0)):e.target===l.current?o(D({itemId:void 0})):c(void 0)},[p,o]),P=(0,u.useCallback)(function(e){if(d.current[e.pointerId]=e,2===Object.values(d.current).length){var t=d.current[Object.keys(d.current)[0]],n=d.current[Object.keys(d.current)[1]],r=Math.sqrt(Math.pow(t.clientX-n.clientX,2)+Math.pow(t.clientY-n.clientY,2)),i={x:(t.clientX+n.clientX)/2-p.left-p.width/2,y:(t.clientY+n.clientY)/2-p.top-p.height/2};o(M({type:"pinch",startPointerDiff:r,currentPointerDiff:r,startCenterPoint:i,currentCenterPoint:i}))}},[p,o]);return(0,u.useEffect)(function(){return window.addEventListener("pointerup",A),(0,j.v)()&&(window.addEventListener("pointercancel",A),window.addEventListener("pointerleave",A),window.addEventListener("pointerout",A)),window.addEventListener("pointermove",I),window.addEventListener("pointerdown",P),function(){window.removeEventListener("pointerup",A),(0,j.v)()&&(window.removeEventListener("pointercancel",A),window.removeEventListener("pointerleave",A),window.removeEventListener("pointerout",A)),window.removeEventListener("pointermove",I),window.removeEventListener("pointerdown",P)}},[A,I,P]),(0,i.jsxs)("div",{id:"weaponpanel",ref:l,className:"flex-grow flex flex-row items-center justify-center relative bg-panel h-full touch-none select-none",style:{outline:"2px solid black"},children:[a,C&&(0,i.jsx)(ee,{attachement:C,state:r,dispatch:o}),S&&(0,i.jsx)($,{bodyPart:S,state:r,dispatch:o})]})}),ei=n(55819),eo=n(32807),ea=n(80791),es=function(e){var t=e.state,n=e.dispatch,r=(0,u.useContext)(eo.dn).t;return(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[(0,i.jsxs)("span",{children:[r("AttachementsWindow.zoom"),":"]}),(0,i.jsxs)(ea.P,{value:[1,2,3,4].includes(t.zoomScale)?"".concat(t.zoomScale):"",onChange:function(e){return n(Z({zoomScale:parseInt(e),moveOffset:{x:0,y:0}}))},children:[(0,i.jsx)(ei.Z,{value:1,children:"1x"}),(0,i.jsx)(ei.Z,{value:2,children:"2x"}),(0,i.jsx)(ei.Z,{value:3,children:"3x"}),(0,i.jsx)(ei.Z,{value:4,children:"4x"})]})]})},ec=n(95027),el=n(85613),ed=n(81069),eu=n(14975),eh=n(61649),em=function(e){var t=e.onImageAdded,n=e.rect,r=e.zoomScale,o=(0,u.useRef)(null);return(0,i.jsxs)(p.z,{className:"px-1",onClick:function(){var e;return null===(e=o.current)||void 0===e?void 0:e.click()},children:[(0,i.jsx)("input",{ref:o,className:"hidden",type:"file",accept:"image/*",onChange:function(e){var i,a=null===(i=e.target.files)||void 0===i?void 0:i[0];void 0!==a&&(0,eh.N)(a,{width:n.width/r,height:n.height/r},function(e,n,r){o.current.value="",t({id:Q()(),item:{id:Q()(),name:{en:a.name},icon:{image:e,width:n,height:r},packId:"default",typeId:eu.nP,skins:[]},isMirrored:!1,rotation:0,scale:1,position:{x:0,y:0}})})}}),"Add image"]})},ef=n(15948),ev=function(e){var t=e.index,n=e.id,r=e.item,o=e.onHover,a=e.onDelete;return(0,i.jsx)(ef._l,{draggableId:n,index:t,children:function(e){return(0,i.jsxs)("div",(0,v._)((0,f._)({className:"h-[60px] flex flex-row items-center justify-center relative border border-black rounded m-2",onMouseOver:function(){return o(!0)},onMouseOut:function(){return o(!1)},style:{outline:"2px solid black"}},e.draggableProps,e.dragHandleProps),{ref:e.innerRef,children:[r,"item"!==n?(0,i.jsx)("div",{className:"absolute right-2 w-6",onClick:a,children:(0,i.jsx)("img",{src:"/delete_FILL0_wght400_GRAD0_opsz40.svg"})}):null]}))}},n)},ex=function(e){var t=e.itemsOrder,n=e.dispatch,r=e.getNodeForItem,o=(0,eo.ql)().t,a=function(e,t){t?n(P({itemId:e})):n(L())},s=function(e){n(H({attachementId:e}))};return(0,i.jsx)(ef.Z5,{onDragEnd:function(e){var r=e.destination,i=e.source,o=e.draggableId;if(r&&(r.droppableId!==i.droppableId||r.index!==i.index)){var a=Array.from(t);a.splice(i.index,1),a.splice(r.index,0,o),n(O({newItemsOrder:a}))}},children:(0,i.jsxs)("div",{className:"flex flex-col h-full",children:[(0,i.jsx)("div",{className:"flex flex-row justify-center border-b-2 border-black",children:(0,i.jsx)("p",{className:"text-center",children:o("AttachementsWindow.attachementsOrder")})}),(0,i.jsx)(ef.bK,{droppableId:"foo",children:function(e){return(0,i.jsxs)("div",(0,v._)((0,f._)({className:"overflow-y-scroll overflow-x-hidden"},e.droppableProps),{ref:e.innerRef,children:[t.map(function(e,t){return(0,i.jsx)(ev,{index:t,id:e,item:r(e),onHover:function(t){return a(e,t)},onDelete:function(){return s(e)}},"".concat(t))}),e.placeholder]}))}})]})})},ep=n(94184),ey=n.n(ep),eg=n(1604),eb=n(60181),ew=n(23508),ej=n(33264),ek=n(64022),e_=function(e){var t=e.onItemTaken,n=(0,r._)((0,u.useState)(!1),2),o=n[0],a=n[1],s=(0,r._)((0,u.useState)({typeId:"RmZUA1_GU9_-DCG7h6zch"}),2),c=s[0],l=s[1],d=(0,u.useContext)(h.Q).scale;return(0,j.v)()?(0,i.jsxs)("div",{className:"flex flex-col",style:{width:240*d},children:[(0,i.jsx)("div",{className:"p-1 flex flex-col items-center border-black border-b bg-button",onClick:function(){return a(!o)},children:(0,i.jsxs)("div",{className:"flex items-center gap-1 cursor-pointer",children:[o?(0,i.jsx)(eb.Z,{}):(0,i.jsx)(ew.Z,{}),(0,i.jsx)("span",{children:"Category"}),o?(0,i.jsx)(eb.Z,{}):(0,i.jsx)(ew.Z,{})]})}),o?(0,i.jsx)("div",{className:"flex-1 overflow-scroll",children:(0,i.jsx)(ek.p,{selectedType:c,onTypeSelected:function(e){l(e),a(!1)}})}):(0,i.jsx)("div",{className:"flex-1 overflow-scroll",children:(0,i.jsx)(ej.r,{onItemTaken:t,size:"medium",selectedItemType:c,sourceScreen:"edit_model"})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-full",style:{width:240*d},children:(0,i.jsx)(ej.r,{onItemTaken:t,size:"small",selectedItemType:c,sourceScreen:"weapon_upgrade"})}),(0,i.jsx)("div",{className:"overflow-y-scroll overflow-x-none border-l border-black",style:{width:140},children:(0,i.jsx)(ek.p,{selectedType:c,onTypeSelected:l})})]})},eI=function(e){switch(e){case q.n6.Body:return;case q.n6.LeftHand:return"invert(20%) sepia(74%) saturate(1990%) hue-rotate(356deg) brightness(104%) contrast(120%)";case q.n6.RightHand:return"invert(66%) sepia(74%) saturate(404%) hue-rotate(83deg) brightness(117%) contrast(125%)";case q.n6.Weapon:return"invert(9%) sepia(98%) saturate(4289%) hue-rotate(248deg) brightness(93%) contrast(144%)";case q.n6.Head:return"invert(43%) sepia(100%) saturate(745%) hue-rotate(288deg) brightness(101%) contrast(101%)"}},eC=function(e){var t,n,s,d=e.onClose,m=(0,u.useContext)(h.Q).scale,x=(0,u.useContext)(a.e4),g=x.model,b=x.setModel,j=x.headIndex,k=(0,l.BC)(function(e){return e.inventory}),S=(0,r._)((0,u.useState)(),2),A=S[0],P=S[1],L=(0,r._)((0,o.r)(),2),B=(L[0],L[1]),H=(0,u.useRef)(null),F=(0,u.useContext)(eo.dn).t,Z=(0,r._)((0,u.useState)(),2),Y=Z[0],W=Z[1],Q=(0,r._)((0,u.useState)(!1),2),J=Q[0],G=Q[1],V=(0,r._)(X(),2),K=V[0],$=V[1],ee=(0,u.useRef)(null),et=(null===(s=ee.current)||void 0===s?void 0:s.getBoundingClientRect())||{left:0,top:0,width:0,height:0};(0,u.useEffect)(function(){$(R({newAttachementsList:g.attachements.map(function(e){return(0,v._)((0,f._)({},e),{position:{x:e.position.x,y:e.position.y}})})})),$(O({newItemsOrder:g.itemsOrder})),$(E({newBodyPartsList:g.bodyParts}))},[g]);var en=function(){b((0,v._)((0,f._)({},g),{attachements:K.attachements.map(function(e){return(0,v._)((0,f._)({},e),{position:{x:e.position.x,y:e.position.y}})}),itemsOrder:K.itemsOrder,bodyParts:K.bodyParts})),d()},ei=function(e){return{x:e.position.x*m*_(K)+N(K,e.layer).x,y:e.position.y*m*_(K)+N(K,e.layer).y}};return(0,ed.q)(en),(0,i.jsx)(y.u,{noScroll:!0,fullscreen:!0,onDismiss:en,children:(0,i.jsxs)("div",{className:"w-full h-full flex flex-row items-stretch justify-center bg-itemList",children:[(0,i.jsx)("div",{style:{width:200*m},children:(0,i.jsx)(ex,{getNodeForItem:function(e){switch(e){case q.n6.LeftHand:case q.n6.RightHand:case q.n6.Body:case q.n6.Weapon:case q.n6.Head:var t=K.bodyParts.find(function(t){return t.layer===e});return(0,i.jsx)("div",{style:{height:60,overflow:"hidden"},children:(0,i.jsx)("div",{style:{transform:"scale(".concat(60/(241*m),")"),transformOrigin:"center top"},children:(0,i.jsx)(ec.S,{ref:H,inventory:k,headIndex:j,bodyPart:t,layer:e})})});default:return(0,i.jsx)("img",{className:"max-h-[50px]",src:K.attachements.find(function(t){return t.id===e}).item.icon.image})}},itemsOrder:K.itemsOrder,dispatch:$})}),(0,i.jsxs)(er,{state:K,dispatch:$,hand:Y,ref:ee,setHand:W,children:[(0,i.jsx)("div",{className:"absolute bottom-2",children:(0,i.jsx)(p.z,{className:"px-6 py-1",onClick:en,children:F("AttachementsWindow.buttonSave")})}),(0,i.jsx)("div",{className:"absolute top-2 right-2 flex flex-row items-center gap-2",children:(0,i.jsx)(eN,{state:K,dispatch:$,settings:B})}),K.itemsOrder.map(function(e,t){switch(e){case q.n6.LeftHand:case q.n6.RightHand:case q.n6.Body:case q.n6.Weapon:case q.n6.Head:var n=K.bodyParts.find(function(t){return t.layer===e}),r=n.rotation+C(K,n.layer),o=ei(n),a=n.scale*I(K,n.layer);return(0,i.jsx)(c.u,{headIndex:j,bodyPart:(0,v._)((0,f._)({},n),{position:o,rotation:r,scale:a}),scale:_(K),inventory:k,zIndex:K.itemsOrder.length-t,filter:e===K.hoveredItemId||A===e?eI(e):void 0});default:var s=K.attachements.find(function(t){return t.id===e});return(0,i.jsx)(U,{state:K,dispatch:$,attachement:s,zIndex:K.itemsOrder.length-t},"image-".concat(s.id))}}),J&&(t=function(e){switch(e){case q.n6.Body:return"B";case q.n6.LeftHand:return"L";case q.n6.RightHand:return"R";case q.n6.Weapon:return"W";case q.n6.Head:return"H"}},n=function(e){switch(e){case q.n6.Body:return"bg-yellow-600";case q.n6.LeftHand:return"bg-red-600";case q.n6.RightHand:return"bg-green-600";case q.n6.Weapon:return"bg-blue-600";case q.n6.Head:return"bg-fuchsia-600"}},K.bodyParts.filter(function(e){return e.layer!==q.n6.Body}).map(function(e){var r=(0,q.lf)(e.layer),o={x:r.x*m*_(K)+ei(e).x,y:r.y*m*_(K)+ei(e).y};return(0,i.jsx)("div",{className:"absolute z-10 pointer-events-none",style:{width:149*m*_(K),height:241*m*_(K)},children:(0,i.jsx)("div",{className:"absolute",style:{left:o.x,top:o.y},children:(0,i.jsx)("div",{className:ey()("-ml-3 -mt-3 w-6 h-6 rounded-full pointer-events-auto flex items-center justify-center cursor-pointer",n(e.layer)),onMouseOver:function(){return P(e.layer)},onMouseOut:function(){return P(void 0)},onClick:function(){e.layer!==q.n6.Body&&$(D({itemId:e.layer}))},onPointerDown:function(t){$(D({itemId:void 0})),$(M({type:"move",itemId:e.layer,start:{x:t.clientX,y:t.clientY},current:{x:t.clientX,y:t.clientY}}))},onPointerUp:function(t){if((null===(n=K.currentDragAction)||void 0===n?void 0:n.type)==="move"){var n,r={x:t.clientX,y:t.clientY};$(z((0,v._)((0,f._)({bodyPartLayer:e.layer},e),{position:{x:e.position.x+(r.x-K.currentDragAction.start.x)/m/_(K),y:e.position.y+(r.y-K.currentDragAction.start.y)/m/_(K)}}))),$(M(void 0))}},children:(0,i.jsx)("span",{className:"text-white text-sm leading-none pointer-events-none",children:t(e.layer)})})})},e.layer)})),(0,i.jsx)(eA,{}),(0,i.jsxs)("div",{className:"absolute top-2 left-2 flex flex-row gap-2",children:[!J&&(0,i.jsx)(p.z,{className:"px-1",onClick:function(){return G(!0)},children:"Edit pose"}),J&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.z,{className:"px-1",onClick:function(){return G(!1)},children:"Finish editing"}),(0,i.jsx)(eS,{state:K,dispatch:$,onReset:function(){$(E({newBodyPartsList:q.CS.bodyParts}))}})]})]}),(0,i.jsx)("div",{className:"absolute bottom-2 left-2",children:(0,i.jsx)(em,{onImageAdded:function(e){gtag("event","add_custom_image",{source_screen:"edit_model"}),$(T({newAttachement:e}))},rect:et,zoomScale:_(K)})}),(0,i.jsx)("div",{className:"absolute bottom-2 right-2",children:(0,i.jsx)(es,{state:K,dispatch:$})})]}),(0,i.jsx)(e_,{onItemTaken:function(e){void 0===Y&&W(e)}}),(0,i.jsx)(w,{children:Y&&(0,i.jsx)("img",{className:"relative",src:Y.icon.image,style:{width:Y.icon.width*m*_(K),height:Y.icon.height*m*_(K),left:-1*Y.icon.width*m*_(K)/2,top:-1*Y.icon.height*m*_(K)/2}})})]})})},eN=function(e){var t,n=e.state,r=e.dispatch,o=e.settings;return(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[(0,i.jsx)("span",{children:"Weapon:"}),(0,i.jsxs)(ea.P,{value:(null===(t=n.bodyParts.find(function(e){return e.layer===q.n6.Weapon}))||void 0===t?void 0:t.weaponModel)||(null==o?void 0:o.weaponModel)||"model",onChange:function(e){var t=n.bodyParts.find(function(e){return e.layer===q.n6.Weapon});r(z((0,v._)((0,f._)({bodyPartLayer:q.n6.Weapon},t),{position:{x:t.position.x,y:t.position.y},weaponModel:e})))},children:[(0,i.jsx)(ei.Z,{value:"model",children:"Default"}),(0,i.jsx)(ei.Z,{value:"real",children:"Real"}),(0,i.jsx)(ei.Z,{value:"realShaded",children:"Shaded"})]})]})},eS=function(e){var t=e.state,n=e.dispatch,r=e.onReset,o=(0,u.useContext)(h.Q).scale,a=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[(0,i.jsx)("span",{children:"Left hand:"}),(0,i.jsxs)(ea.P,{value:t.bodyParts.find(function(e){return e.layer===q.n6.LeftHand}).handType||"default",onChange:function(e){var r=t.bodyParts.find(function(e){return e.layer===q.n6.LeftHand}),i=(0,x._)(t.itemsOrder);void 0===r.handType&&"default"!==e?(i.splice(i.indexOf(q.n6.LeftHand),1),i.splice(i.indexOf(q.n6.Body)+1,0,q.n6.LeftHand)):void 0!==r.handType&&"default"===e&&(i.splice(i.indexOf(q.n6.LeftHand),1),i.splice(i.indexOf(q.n6.RightHand)+1,0,q.n6.LeftHand)),n(O({newItemsOrder:i})),n(z((0,v._)((0,f._)({bodyPartLayer:q.n6.LeftHand},r),{position:{x:r.position.x,y:r.position.y},handType:"default"===e?void 0:e})))},children:[(0,i.jsx)(ei.Z,{value:"default",children:"Default"}),(0,i.jsx)(ei.Z,{value:"unarmed",children:"Unarmed"}),(0,i.jsx)(ei.Z,{value:"armed",children:"Armed"})]})]}),(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[(0,i.jsx)("span",{children:"Right hand:"}),(0,i.jsxs)(ea.P,{value:t.bodyParts.find(function(e){return e.layer===q.n6.RightHand}).handType||"default",onChange:function(e){return n(z((0,v._)((0,f._)({bodyPartLayer:q.n6.RightHand},t.bodyParts.find(function(e){return e.layer===q.n6.RightHand})),{handType:"default"===e?void 0:e})))},children:[(0,i.jsx)(ei.Z,{value:"default",children:"Default"}),(0,i.jsx)(ei.Z,{value:"unarmed",children:"Unarmed"}),(0,i.jsx)(ei.Z,{value:"armed",children:"Armed"})]})]}),(0,i.jsx)(p.z,{className:"px-1",onClick:r,buttonType:"destructive",children:"Reset pose"})]});return(0,j.v)()?(0,i.jsx)(eg.h,{children:(0,i.jsx)("div",{className:"absolute top-0 bottom-0 right-0 z-10 bg-itemList border border-gray-600 flex flex-col items-center px-2 py-1 gap-2",style:{width:240*o},children:a})}):a},eA=function(e){(0,m._)(e);var t=(0,u.useContext)(a.e4),n=t.headIndex,r=t.setHeadIndex;return(0,i.jsxs)("div",{className:" w-full h-full absolute flex items-center justify-between p-2 pointer-events-none",children:[(0,i.jsx)("div",{className:"cursor-pointer flex items-center justify-center pointer-events-auto",style:{width:40,height:40},onClick:function(){r(0===n?el.KG.length-1:n-1)},children:(0,i.jsx)("img",{style:{width:40},src:"/chevron-left.png"})}),(0,i.jsx)("div",{className:"cursor-pointer flex items-center justify-center pointer-events-auto",style:{width:40,height:40},onClick:function(){r(n===el.KG.length-1?0:n+1)},children:(0,i.jsx)("img",{style:{width:40},src:"/chevron-right.png"})})]})},eP=function(){var e=(0,u.useContext)(h.Q).scale,t=(0,r._)((0,u.useState)(!1),2),n=t[0],o=t[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex items-center justify-center cursor-pointer",style:{width:40*e,height:40*e},onClick:function(e){gtag("event","upgrade_model_click"),o(!0)},children:(0,i.jsx)("img",{style:{width:30*e},src:"/gear.svg"})}),n&&(0,i.jsx)(eC,{onClose:function(){o(!1)}})]})},eL=function(e){var t,n=e.onClose,o=(0,l.BC)(function(e){return e.inventory}).main||eu.F3,a=(0,l.sl)(),c=(0,r._)(X(),2),d=c[0],m=c[1],g=(0,r._)((0,u.useState)(),2),b=g[0],k=g[1],I=(0,eo.ql)().t,C=(0,u.useContext)(h.Q).scale,S=C*_(d),A=(0,u.useRef)(null),P=(null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0,width:0,height:0};(0,u.useEffect)(function(){m(R({newAttachementsList:(null===(e=o.attachements)||void 0===e?void 0:e.map(function(e){return(0,v._)((0,f._)({},e),{position:{x:e.position.x,y:e.position.y},rotation:e.rotation||0})}))||[]}));var e,t=[];o.id!==eu.F3.id&&t.push("item"),t.push.apply(t,(0,x._)((o.attachements||[]).map(function(e){return e.id}))),m(O({newItemsOrder:o.itemsOrder||t}))},[o]);var L=function(){(o.id!==eu.F3.id||d.attachements.length>0)&&a((0,s.Qr)({slot:"main",index:0,items:[(0,v._)((0,f._)({},o),{attachements:d.attachements.map(function(e){return(0,v._)((0,f._)({},e),{position:{x:e.position.x,y:e.position.y},rotation:e.rotation||0})}),itemsOrder:d.itemsOrder,properties:o.properties})]})),n()};return(0,ed.q)(L),(0,i.jsx)(y.u,{noScroll:!0,fullscreen:!0,onDismiss:L,children:(0,i.jsxs)("div",{onContextMenu:function(e){(0,j.T)()||(e.preventDefault(),L())},className:"w-full h-full flex flex-row items-stretch justify-center bg-itemList",children:[(0,i.jsx)("div",{style:{width:200*C},children:(0,i.jsx)(ex,{itemsOrder:d.itemsOrder,dispatch:m,getNodeForItem:function(e){return(0,i.jsx)("img",{className:"max-h-[50px]",src:"item"===e?o.icon.image:d.attachements.find(function(t){return t.id===e}).item.icon.image})}})}),(0,i.jsxs)(er,{state:d,dispatch:m,hand:b,ref:A,setHand:k,children:[d.itemsOrder.map(function(e,t){if("item"===e){var n=N(d,e);return(0,i.jsx)("div",{draggable:!1,className:"absolute",style:{pointerEvents:"none",zIndex:d.itemsOrder.length-t,filter:"item"===d.hoveredItemId?Y:void 0,width:o.icon.width*S,height:o.icon.height*S,transform:"translate(".concat(n.x,"px, ").concat(n.y,"px)")},children:(0,i.jsx)("img",{className:"w-full h-full",src:o.icon.image,alt:""})},"image-".concat(e))}var r=d.attachements.find(function(t){return t.id===e});return(0,i.jsx)(U,{state:d,dispatch:m,attachement:r,zIndex:d.itemsOrder.length-t},"image-".concat(r.id))}),(0,i.jsx)("div",{className:"absolute bottom-2",children:(0,i.jsx)(p.z,{className:"px-6 py-1",onClick:L,children:I("AttachementsWindow.buttonSave")})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)(es,{state:d,dispatch:m})}),(0,i.jsx)("div",{className:"absolute bottom-2 left-2",children:(0,i.jsx)(em,{onImageAdded:function(e){gtag("event","add_custom_image",{source_screen:"edit_weapon"}),m(T({newAttachement:e}))},rect:P,zoomScale:d.zoomScale})})]}),(0,i.jsx)(e_,{onItemTaken:function(e){void 0===b&&k(e)}}),(0,i.jsx)(w,{children:b&&(0,i.jsx)("img",{className:"relative",src:b.icon.image,style:{width:b.icon.width*S,height:b.icon.height*S,left:-1*b.icon.width*S/2,top:-1*b.icon.height*S/2}})})]})})},eE=function(){var e=(0,u.useContext)(h.Q).scale,t=(0,r._)((0,u.useState)(!1),2),n=t[0],o=t[1];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex items-center justify-center cursor-pointer",style:{width:40*e,height:40*e},onClick:function(e){gtag("event","upgrade_click"),o(!0)},children:(0,i.jsx)("img",{style:{width:30*e},src:"/gear.svg"})}),n&&(0,i.jsx)(eL,{onClose:function(){return o(!1)}})]})},ez=n(31318),eD=function(e){var t,n=e.x,r=e.y,o=e.width,a=e.height,c=e.slot,m=e.index,f=(0,u.useContext)(h.Q).scale,v=(0,l.BC)(function(e){return e.inventory}),x=(0,l.sl)(),p=!1;if((0,s.ON)(c))t=v[c][m||0];else if((0,s.zr)(c))t=v[c];else{p=!0;var y=v[c];t=y?[y]:void 0}var g=(0,s.zr)(c);return(0,i.jsxs)("div",{className:"absolute",style:{width:(o||70)*f,height:(a||70)*f,top:r*f,left:n*f},children:[(0,i.jsx)(ez.z,{width:o||70,height:a||70,items:t,singleItem:p,enabled:!!t&&t.length>0,expandable:g,onItemsChanged:function(e){return x((0,s.Qr)({slot:c,index:m,items:e}))}}),g&&(0,i.jsx)("span",{className:"absolute pointer-events-none text-white font-bold text-end select-none ".concat(d.benderBoldFont.className),style:{bottom:-2*f,right:2*f,width:"100%",fontSize:14,transform:"scale(".concat(f,")"),transformOrigin:"right bottom",textShadow:"0 0 2px black",zIndex:2,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:t&&t.length>1?"+".concat(t.length-1):""})]})},eO=(0,u.forwardRef)(function(e,t){var n=(0,u.useContext)(h.Q),r=n.scale,o=n.isSavingImage,s=(0,u.useContext)(a.e4),d=(s.setSelectedItemType,s.headIndex),m=s.model,f=(0,u.useRef)(null),v=(0,u.useRef)(null),x=(0,l.BC)(function(e){return e.inventory});return(0,u.useImperativeHandle)(t,function(){return{getPanelRef:function(){return f},getCharacterModelRef:function(){return v}}}),(0,i.jsxs)("div",{ref:f,style:{position:"relative",flexShrink:0,width:680*r,height:650*r,overflow:"hidden"},children:[(0,i.jsxs)("div",{className:"relative z-0",children:[(0,i.jsx)("div",{className:"absolute",style:{backgroundImage:'url("/inv_2_model_bg.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",top:53*r,left:91*r,width:199*r,height:297*r}}),(0,i.jsxs)("div",{className:"",style:{left:120*r,top:98*r,width:149*r,height:241*r,position:"absolute"},children:[(0,i.jsx)(c.r,{ref:v,inventory:x,model:m,headIndex:d}),(0,i.jsx)("div",{className:"absolute cursor-pointer",style:{bottom:0,right:-6,zIndex:m.itemsOrder.length+2},children:!o&&(0,i.jsx)(eP,{})})]}),(0,i.jsx)("div",{className:"absolute",style:{backgroundImage:'url("/inv_2.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:680*r,height:650*r,zIndex:m.itemsOrder.length+1}})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(eD,{x:40,y:430,width:292,height:120,slot:"main"}),(0,i.jsx)("div",{className:"flex absolute items-center justify-center",style:{top:510*r,left:292*r},children:!o&&(0,i.jsx)(eE,{})})]}),(0,i.jsx)(eD,{x:357,y:492,width:144,height:105,slot:"sub1"}),(0,i.jsx)(eD,{x:505,y:492,width:144,height:105,slot:"sub2"}),(0,i.jsx)(eD,{x:32,y:554,slot:"scope"}),(0,i.jsx)(eD,{x:114,y:554,slot:"barrelBottom"}),(0,i.jsx)(eD,{x:188,y:554,slot:"barrelSide"}),(0,i.jsx)(eD,{x:270,y:554,slot:"muzzle"}),(0,i.jsx)(eD,{x:283,y:98,slot:"vest"}),Array.range(0,3).map(function(e){return(0,i.jsx)(eD,{x:357+74*e,y:24,slot:"vestCells",index:e},"vest-".concat(e))}),Array.range(0,1).map(function(e){return(0,i.jsx)(eD,{x:357+148*e,y:98,width:144,slot:"vestCells",index:4+e},"vest-2-".concat(e))}),(0,i.jsx)(eD,{x:283,y:180,slot:"pouch"}),(0,i.jsx)(eD,{x:357,y:180,slot:"pouchCells",index:0}),(0,i.jsx)(eD,{x:431,y:180,slot:"pouchCells",index:1}),(0,i.jsx)(eD,{x:505,y:180,width:144,slot:"pouchCells",index:2}),(0,i.jsx)(eD,{x:29,y:16,slot:"radio"}),(0,i.jsx)(eD,{x:29,y:98,slot:"helmet"}),(0,i.jsx)(eD,{x:29,y:180,slot:"armour"}),(0,i.jsx)(eD,{x:29,y:262,slot:"clothes"}),(0,i.jsx)(eD,{x:115,y:16,slot:"eyes"}),(0,i.jsx)(eD,{x:189,y:16,slot:"mask"}),(0,i.jsx)(eD,{x:275,y:16,slot:"patch"}),(0,i.jsx)(eD,{x:29,y:344,slot:"pockets",index:0}),(0,i.jsx)(eD,{x:111,y:344,slot:"pockets",index:1}),(0,i.jsx)(eD,{x:193,y:344,slot:"pockets",index:2}),(0,i.jsx)(eD,{x:275,y:344,slot:"pockets",index:3}),(0,i.jsx)(eD,{x:283,y:262,slot:"backpack"}),Array.range(0,2).map(function(e){return Array.range(0,2).map(function(t){return(0,i.jsx)(eD,{x:357+74*t,y:262+74*e,width:2===t?144:70,slot:"backpackCells",index:5*e+t},"backpack-".concat(e,"-").concat(t))})})]})}),eR=(0,u.forwardRef)(function(e,t){var n=(0,u.useContext)(h.Q),r=n.scale,o=n.isSavingImage,s=(0,l.BC)(function(e){return e.inventory}),d=(0,u.useContext)(a.e4),m=d.model,f=d.headIndex,v=(0,u.useContext)(eo.dn).t,x=(0,u.useRef)(null),p=(0,u.useRef)(null);return(0,u.useImperativeHandle)(t,function(){return{getPanelRef:function(){return x},getCharacterModelRef:function(){return p}}}),(0,i.jsxs)("div",{ref:x,style:{position:"relative",flexShrink:0,width:799*r,height:748*r,overflow:"hidden"},children:[(0,i.jsxs)("div",{className:"relative z-0",children:[(0,i.jsxs)("div",{className:"absolute flex items-center justify-center",style:{top:134*r,left:406*r,width:168*r,height:280*r,background:"repeating-linear-gradient(135deg, #3d372c, #3d372c 2px, #484337 2px, #484337 6px)"},children:[(0,i.jsx)(c.r,{ref:p,inventory:s,model:m,headIndex:f}),(0,i.jsx)("div",{className:"absolute cursor-pointer",style:{bottom:0,left:0,zIndex:m.itemsOrder.length+2},children:!o&&(0,i.jsx)(eP,{})})]}),(0,i.jsx)("div",{className:"absolute",style:{backgroundImage:'url("/EFT.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:799*r,height:748*r,zIndex:m.itemsOrder.length+1}})]}),(0,i.jsx)(eT,{x:12,y:16,height:144,slot:"vestCells",index:0}),(0,i.jsx)(eT,{x:86,y:16,height:144,slot:"vestCells",index:1}),(0,i.jsx)(eT,{x:168,y:12,slot:"vestCells",index:2}),(0,i.jsx)(eT,{x:168,y:94,slot:"vestCells",index:3}),(0,i.jsx)(eT,{x:250,y:16,height:144,slot:"vestCells",index:4}),(0,i.jsx)(eT,{x:324,y:16,height:144,slot:"vestCells",index:5}),(0,i.jsx)(eT,{x:12,y:176,slot:"pockets",index:0}),(0,i.jsx)(eT,{x:94,y:176,slot:"pockets",index:1}),(0,i.jsx)(eT,{x:176,y:176,slot:"pockets",index:2}),(0,i.jsx)(eT,{x:258,y:176,slot:"pockets",index:3}),Array.range(0,1).map(function(e){return Array.range(0,4).map(function(t){return(0,i.jsx)(eT,{x:19+74*t,y:258+74*e,slot:"pouchCells",index:5*e+t},"pouch-".concat(e,"-").concat(t))})}),Array.range(0,3).map(function(e){return Array.range(0,1).map(function(t){return(0,i.jsx)(eT,{x:12+74*t,y:426+74*e,slot:"backpackCells",index:2*e+t},"backpack-".concat(e,"-").concat(t))})}),(0,i.jsx)(eT,{x:168,y:414,slot:"backpackCells",index:8}),(0,i.jsx)(eT,{x:168,y:496,slot:"backpackCells",index:9}),(0,i.jsx)(eT,{x:168,y:578,slot:"backpackCells",index:10}),(0,i.jsx)(eT,{x:168,y:660,slot:"backpackCells",index:11}),Array.range(0,3).map(function(e){return Array.range(0,1).map(function(t){return(0,i.jsx)(eT,{x:250+74*t,y:426+74*e,slot:"backpackCells",index:12+2*e+t},"backpack-".concat(e,"-").concat(t))})}),(0,i.jsx)(eT,{x:340,y:176,slot:"clothes",label:v("EFTInventory.clothes")}),(0,i.jsx)(eT,{x:406,y:52,slot:"vest",label:v("EFTInventory.vest")}),(0,i.jsx)(eT,{x:488,y:52,slot:"helmet",label:v("EFTInventory.head")}),(0,i.jsx)(eT,{x:570,y:52,slot:"eyes",label:v("EFTInventory.eyes")}),(0,i.jsx)(eT,{x:652,y:52,slot:"mask",label:v("EFTInventory.mask")}),(0,i.jsx)(eT,{x:570,y:156,slot:"armour",label:v("EFTInventory.armor")}),(0,i.jsx)(eT,{x:570,y:238,slot:"patch",label:v("EFTInventory.patch")}),(0,i.jsx)(eT,{x:570,y:320,slot:"radio",label:v("EFTInventory.radio")}),(0,i.jsx)(eT,{x:406,y:426,slot:"pouch",label:v("EFTInventory.bag")}),(0,i.jsx)(eT,{x:406,y:508,slot:"backpack",label:v("EFTInventory.backpack")}),(0,i.jsx)(eT,{x:488,y:426,width:146,height:105,slot:"sub1",label:v("EFTInventory.belt")}),(0,i.jsx)(eT,{x:634,y:426,width:146,height:105,slot:"sub2"}),(0,i.jsx)(eT,{x:488,y:543,width:292,height:120,slot:"main",label:v("EFTInventory.inHands"),showItemName:!0}),(0,i.jsx)("div",{className:"absolute",style:{top:623*r,left:488*r},children:!o&&(0,i.jsx)(eE,{})}),(0,i.jsx)(eT,{x:480,y:667,slot:"scope"}),(0,i.jsx)(eT,{x:562,y:667,slot:"barrelBottom"}),(0,i.jsx)(eT,{x:636,y:667,slot:"barrelSide"}),(0,i.jsx)(eT,{x:718,y:667,slot:"muzzle"})]})}),eT=function(e){var t,n=e.x,r=e.y,o=e.width,a=e.height,c=e.slot,m=e.index,f=e.label,v=e.showItemName,x=(0,u.useContext)(h.Q).scale,p=(0,l.BC)(function(e){return e.inventory}),y=(0,l.sl)(),g=(0,u.useContext)(eo.dn).getTranslation;if((0,s.ON)(c))t=p[c][m||0];else if((0,s.zr)(c))t=p[c];else{var b=p[c];t=b?[b]:void 0}var w=(0,s.zr)(c);return(0,i.jsxs)("div",{className:"absolute",style:{width:(o||70)*x,height:(a||70)*x,top:r*x,left:n*x},children:[(0,i.jsx)(ez.z,{width:o||70,height:a||70,items:t,singleItem:!1===Array.isArray(p[c]),enabled:!0,expandable:w,onItemsChanged:function(e){return y((0,s.Qr)({slot:c,index:m,items:e}))}}),(0,i.jsx)("span",{className:"absolute text-white font-bold select-none ".concat(d.benderBoldFont.className),style:{top:-2*x,left:1*x,fontSize:10,transform:"scale(".concat(x,")"),transformOrigin:"left top",textShadow:"0 0 2px black",zIndex:2},children:f}),!0===v?(0,i.jsx)("span",{className:"absolute text-white font-bold text-end select-none ".concat(d.benderBoldFont.className),style:{bottom:-1*x,right:1*x,width:"100%",fontSize:8,transform:"scale(".concat(x,")"),transformOrigin:"right bottom",textShadow:"0 0 2px black",zIndex:2,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:t&&t.length>0?g(t[0].name):""}):null,w&&(0,i.jsx)("span",{className:"absolute pointer-events-none text-white font-bold text-end select-none ".concat(d.benderBoldFont.className),style:{bottom:-2*x,right:2*x,width:"100%",fontSize:14,transform:"scale(".concat(x,")"),transformOrigin:"right bottom",textShadow:"0 0 2px black",zIndex:2,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:t&&t.length>1?"+".concat(t.length-1):""})]})},eB=function(e){var t,n=e.x,r=e.y,o=e.width,a=e.height,c=e.slot,m=e.index,f=(0,u.useContext)(h.Q).scale,v=(0,l.BC)(function(e){return e.inventory}),x=(0,l.sl)(),p=!1;if((0,s.ON)(c))t=v[c][m||0];else if((0,s.zr)(c))t=v[c];else{p=!0;var y=v[c];t=y?[y]:void 0}var g=(0,s.zr)(c);return(0,i.jsxs)("div",{className:"absolute",style:{width:(o||70)*f,height:(a||70)*f,top:r*f,left:n*f},children:[(0,i.jsx)(ez.z,{width:o||70,height:a||70,items:t,singleItem:p,enabled:!0,onItemsChanged:function(e){return x((0,s.Qr)({slot:c,index:m,items:e}))},expandable:g}),g&&(0,i.jsx)("span",{className:"absolute pointer-events-none text-white font-bold text-end select-none ".concat(d.benderBoldFont.className),style:{bottom:-2*f,right:2*f,width:"100%",fontSize:14,transform:"scale(".concat(f,")"),transformOrigin:"right bottom",textShadow:"0 0 2px black",zIndex:2,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:t&&t.length>1?"+".concat(t.length-1):""})]})},eH=(0,u.forwardRef)(function(e,t){var n=(0,u.useContext)(h.Q),r=n.scale,o=n.isSavingImage,s=(0,u.useContext)(a.e4),d=(s.setSelectedItemType,s.headIndex),m=s.model,f=(0,u.useRef)(null),v=(0,u.useRef)(null),x=(0,l.BC)(function(e){return e.inventory}),p=eM("metro").width*r,y=eM("metro").height*r;return(0,u.useImperativeHandle)(t,function(){return{getPanelRef:function(){return f},getCharacterModelRef:function(){return v}}}),(0,i.jsxs)("div",{ref:f,style:{position:"relative",flexShrink:0,width:p,height:y,overflow:"hidden"},children:[(0,i.jsxs)("div",{className:"relative z-0",children:[(0,i.jsx)("div",{className:"absolute",style:{backgroundImage:'url("/inv_metro_2.png")',backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",width:p,height:y}}),(0,i.jsxs)("div",{style:{left:110*r,top:98*r,width:149*r,height:241*r,position:"absolute"},children:[(0,i.jsx)(c.r,{ref:v,inventory:x,model:m,headIndex:d}),(0,i.jsx)("div",{className:"absolute cursor-pointer",style:{bottom:0,right:-6,zIndex:m.itemsOrder.length+1},children:!o&&(0,i.jsx)(eP,{})})]})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(eB,{x:44,y:462,width:292,height:105,slot:"main"}),(0,i.jsx)("div",{className:"flex absolute items-center justify-center",style:{top:527*r,left:296*r},children:!o&&(0,i.jsx)(eE,{})})]}),(0,i.jsx)(eB,{x:274,y:97,slot:"vest"}),(0,i.jsx)(eB,{x:274,y:179,slot:"pouch"}),(0,i.jsx)(eB,{x:29,y:15,slot:"radio"}),(0,i.jsx)(eB,{x:29,y:97,slot:"helmet"}),(0,i.jsx)(eB,{x:29,y:179,slot:"armour"}),(0,i.jsx)(eB,{x:29,y:261,slot:"clothes"}),(0,i.jsx)(eB,{x:115,y:15,slot:"eyes"}),(0,i.jsx)(eB,{x:189,y:15,slot:"mask"}),(0,i.jsx)(eB,{x:275,y:15,slot:"patch"}),(0,i.jsx)(eB,{x:29,y:343,slot:"pockets",index:0}),(0,i.jsx)(eB,{x:111,y:343,slot:"pockets",index:1}),(0,i.jsx)(eB,{x:193,y:343,slot:"pockets",index:2}),(0,i.jsx)(eB,{x:275,y:343,slot:"pockets",index:3}),(0,i.jsx)(eB,{x:274,y:261,slot:"backpack"}),(0,i.jsx)(eB,{x:365,y:15,slot:"vestCells",index:0}),(0,i.jsx)(eB,{x:453,y:15,slot:"vestCells",index:1}),(0,i.jsx)(eB,{x:540,y:15,slot:"vestCells",index:2}),(0,i.jsx)(eB,{x:627,y:15,slot:"vestCells",index:3}),(0,i.jsx)(eB,{x:385,y:97,width:144,slot:"vestCells",index:4}),(0,i.jsx)(eB,{x:533,y:97,width:144,slot:"vestCells",index:5}),(0,i.jsx)(eB,{x:365,y:179,slot:"pouchCells",index:0}),(0,i.jsx)(eB,{x:459,y:179,width:144,slot:"pouchCells",index:1}),(0,i.jsx)(eB,{x:627,y:179,slot:"pouchCells",index:2}),(0,i.jsx)(eB,{x:385,y:260,width:101,slot:"backpackCells",index:0}),(0,i.jsx)(eB,{x:490,y:260,width:187,slot:"backpackCells",index:1}),Array.range(0,3).map(function(e){return(0,i.jsx)(eB,{x:385+74*e,y:343,slot:"backpackCells",index:2+e},"backpack-".concat(e))}),Array.range(0,3).map(function(e){return(0,i.jsx)(eB,{x:385+74*e,y:426,slot:"backpackCells",index:6+e},"backpack-".concat(e))}),(0,i.jsx)(eB,{x:383,y:520,width:292,height:105,slot:"sub1"})]})}),eM=function(e){switch(e){case"innawoods":return{height:650,width:680};case"eft":return{height:748,width:799};case"metro":return{height:649,width:734};default:return{width:0,height:0}}},eF=(0,u.forwardRef)(function(e,t){var n=(0,r._)((0,o.r)(),2),a=n[0],s=n[1];if(void 0===s||a)return null;switch(s.inventoryTemplate){case"innawoods":return(0,i.jsx)(eO,{ref:t});case"eft":return(0,i.jsx)(eR,{ref:t});case"metro":return(0,i.jsx)(eH,{ref:t});default:return null}})},94478:function(e,t,n){n.d(t,{Lv:function(){return a},ON:function(){return i},Qr:function(){return l},cW:function(){return d},zr:function(){return o}});var r=n(77236);n(67294);var i=function(e){return["pockets","vestCells","pouchCells","backpackCells"].includes(e)},o=function(e){return["patch","helmet","armour","clothes","eyes","mask","radio","vest","pouch","backpack"].includes(e)},a={pockets:[],vestCells:[],pouchCells:[],backpackCells:[]},s=(0,r.oM)({name:"inventory",initialState:a,reducers:{itemChanged:function(e,t){var n=t.payload,r=n.slot,a=n.items,s=n.index;i(r)?e[r][s||0]=a:o(r)?e[r]=a:e[r]=a[0]},inventoryLoaded:function(e,t){return t.payload}}}),c=s.actions,l=c.itemChanged,d=c.inventoryLoaded;t.ZP=s.reducer},33264:function(e,t,n){n.d(t,{r:function(){return en}});var r=n(11010),i=n(24043),o=n(70655),a=n(85893),s=n(14571),c=n(97169),l=n(19592),d=n(248),u=n(30891),h=n(18726),m=n(73842),f=n(31955),v=n(67294),x=n(26040),p=function(e){var t=e.onClose,n=(0,i._)((0,v.useState)(),2),r=n[0],o=n[1];return(0,a.jsx)(c.u,{onDismiss:t,fullscreen:!0,noScroll:!0,children:(0,a.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-2 p-1",children:[(0,a.jsx)(h.w,{onClick:function(){s.u.get({key:"saves"}).then(function(e){o(e.value?e.value:"No saves")})},children:"Read saves"}),(0,a.jsx)(h.w,{onClick:function(){r&&(s.u.set({key:"saves",value:r}),alert("Saves written!"))},children:"Write saves"}),(0,a.jsx)(h.w,{onClick:t,className:"ml-auto mr-0",children:"Close"})]}),(0,a.jsx)("textarea",{className:"w-full h-full",value:r,onChange:function(e){return o(e.target.value)}})]})})},y=function(){var e=(0,i._)((0,v.useState)(!1),2),t=e[0],n=e[1],c=(0,i._)((0,v.useState)([]),2),l=c[0],y=c[1];return(0,v.useEffect)(function(){var e;y([]),m.XP.skip(1).forEach((e=(0,r._)(function(e){var t;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,s.u.get({key:"saves_v".concat(e.from)})];case 1:return null!==(t=n.sent().value)&&(1===e.from&&console.log(t),y(function(n){return(0,d._)(n).concat([{version:e.from,saves:JSON.parse(t).saves}])})),[2]}})}),function(t){return e.apply(this,arguments)}))},[]),console.log(l),(0,a.jsxs)("div",{className:"w-3/4 h-3/4 bg-itemList flex flex-col items-start gap-2 p-2",children:[(0,a.jsx)(h.w,{onClick:function(){u.fy.deleteFile({path:"updates.json",directory:u.tP.Data}),u.fy.deleteFile({path:"categories.json",directory:u.tP.Data}),(0,x.g)().forEach(function(e){return u.fy.deleteFile({path:e.filename,directory:u.tP.Data})}),f.Z.remove("LAST_SEEN_UPDATE")},children:"Clear items cache"}),(0,a.jsx)(h.w,{onClick:function(){return n(!0)},children:"Edit saves"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 border border-black p-2 overflow-y-auto",children:[(0,a.jsx)("span",{children:"Save backups"}),l.map(function(e){return(0,a.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,a.jsxs)("span",{children:["v",e.version,": ",e.saves.length," save(s)"]}),(0,a.jsx)(h.w,{onClick:(0,r._)(function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,s.u.set({key:"saves",value:JSON.stringify({version:e.version,saves:e.saves})})];case 1:return t.sent(),alert("Done"),[2]}})}),children:"Restore"})]},e.version)})]}),t&&(0,a.jsx)(p,{onClose:function(){return n(!1)}})]})},g=n(32807),b=n(11163),w=n(7935),j=n(50594),k=n(42761),_=n(93946),I=n(81069),C=n(12796),N=n(72253),S=n(14932),A=n(14948),P=n(16078),L=n(23926),E=n(90629),z=n(55819),D=n(25594),O=n(75395),R=n(43537),T=n(80791),B=function(e){(0,C._)(e);var t=(0,g.ql)().getTranslation,n=(0,v.useRef)(null),r=(0,v.useRef)(null),o=(0,i._)((0,v.useState)(!1),2),s=o[0],c=o[1],l=(0,v.useContext)(R.e4),u=l.filters,h=l.setFilters,m=function(e){h((0,S._)((0,N._)({},u),{country:"all"===e?void 0:e}))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.Z,{ref:n,"aria-label":"filter list",onClick:function(){c(function(e){return!e})},className:"dark:!text-gray-200",children:(0,a.jsx)(A.Z,{color:"primary",variant:"dot",invisible:!(void 0!==u.country),children:(0,a.jsx)(O.Z,{})})}),(0,a.jsx)(P.Z,{ref:r,style:{zIndex:99999},open:s,anchorEl:n.current,children:(0,a.jsx)(L.Z,{mouseEvent:"onMouseUp",onClickAway:function(e){var t;null!==(t=n.current)&&void 0!==t&&t.contains(e.target)||c(!1)},children:(0,a.jsx)(E.Z,{elevation:4,children:(0,a.jsxs)("div",{className:"bg-itemList w-72 flex flex-col dark:text-gray-200",children:[(0,a.jsx)("span",{className:"w-full py-1 px-2 text-center font-bold border-b border-black",children:"Filters"}),(0,a.jsx)("div",{className:"flex-1 flex flex-col p-2",children:(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("span",{className:"font-bold ",children:"Country:"}),(0,a.jsx)(T.P,{className:"w-full",style:{height:30},value:u.country||"all",onChange:function(e){return m(e)},children:[{code:"all",name:{en:"All countries",ru:"Все страны"}}].concat((0,d._)((0,d._)(D.h).sort(function(e,n){return t(e.name).localeCompare(t(n.name))}))).map(function(e){return(0,a.jsx)(z.Z,{value:e.code,children:(0,a.jsxs)("div",{className:"flex flex-row items-center",children:["all"!==e.code&&(0,a.jsx)("span",{className:"fi fi-".concat(e.code," mr-2 h-8 w-8")}),(0,a.jsx)("span",{children:t(e.name)})]})},e.code)})})]})})]})})})})]})},H=function(e){var t=e.title,n=e.searchTerm,r=e.setSearchTerm,i=e.sourceScreen,o=e.hideFilters,s=(0,v.useRef)(null),c=function(){r(void 0)};return(0,I.q)(c),(0,a.jsxs)("div",{className:"w-full border-b border-black flex flex-row justify-between items-center",children:[!o&&(0,a.jsx)(B,{}),(0,a.jsx)("input",{ref:s,disabled:void 0===n,size:1,className:"text-md font-bold text-center bg-transparent flex-1 ".concat(void 0!==n?"outline outline-black outline-2 rounded":""),value:void 0!==n?n:t,onChange:function(e){return r(e.target.value)}}),void 0!==n?(0,a.jsx)(_.Z,{onClick:c,className:"dark:!text-gray-200",children:(0,a.jsx)(j.Z,{})}):(0,a.jsx)(_.Z,{onClick:function(){gtag("event","search_start",{event_category:"search",source_screen:i}),r(""),setTimeout(function(){var e;null===(e=s.current)||void 0===e||e.focus()},100)},className:"dark:!text-gray-200",children:(0,a.jsx)(k.Z,{})})]})},M=n(94760),F=n(14975),Z=n(78726),X=function(e){var t=e.children,n=e.onDragStart,r=e.mode,i=e.setTooltipPos,o=e.setHover;(0,v.useContext)(M.Q).scale;var s=(0,v.useRef)(null),c=(0,v.useRef)(),l=(0,v.useCallback)(function(e){(void 0===r||void 0!==c.current&&("horizontal"===r?Math.abs(e.touches[0].clientY-c.current.y)>20:Math.abs(e.touches[0].clientX-c.current.x)>20))&&e.cancelable&&(n(),s.current&&s.current.removeEventListener("touchmove",l))},[r,n]);return(0,v.useEffect)(function(){var e=s.current;return e&&e.addEventListener("touchmove",l,{passive:!1}),function(){null==e||e.removeEventListener("touchmove",l)}},[l]),(0,a.jsx)("div",{ref:s,className:"w-full h-full",style:{cursor:"pointer",WebkitTapHighlightColor:"transparent",userSelect:"none",touchAction:"horizontal"===r?"pan-x":"pan-y"},onClick:function(t){(0,Z.T)()||e.onClick()},onTouchStart:function(e){c.current={x:e.touches[0].clientX,y:e.touches[0].clientY},o(!0);var t,n=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect();n&&i({x:n.x+n.width/2,y:n.y})},onTouchEnd:function(){c.current=void 0,o(!1)},onMouseMove:function(e){(0,Z.T)()||i({x:e.clientX,y:e.clientY})},onMouseOver:function(){(0,Z.T)()||o(!0)},onMouseOut:function(){(0,Z.T)()||o(!1)},children:t})},Y=n(78385),U=function(e,t){var n=(0,i._)((0,v.useState)(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(value){var r=n.value;r!==value&&(n.value=value,n.callback(value,r))}}}}),1)[0];return n.callback=t,n.facade},W=n(53852),Q=function(e){var t,n,r=e.item,o=e.left,s=e.top,c=(0,v.useContext)(g.dn).getTranslation,l=(0,v.useContext)(M.Q).scale,d=(0,v.useContext)(W.V).enabledMods,u=(0,i._)((0,v.useState)({width:0,height:0}),2),h=u[0],m=u[1],f=U(null,function(e){var t=null==e?void 0:e.getBoundingClientRect();t&&m({width:t.width,height:t.height})});(0,Z.T)()?(t=o-h.width/2,n=s-h.height-8*l):(t=o+10,n=s+10);var x=null==d?void 0:d.find(function(e){return e.id===r.packId});return(0,a.jsx)(Y.Z,{children:(0,a.jsx)("div",{ref:f,style:{left:0,top:0,position:"fixed",transform:"translate(".concat(t,"px, ").concat(n,"px) scale(").concat(l,")"),transformOrigin:"left top",userSelect:"none",zIndex:9999},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",border:"2px solid black",padding:8},className:"bg-panel",children:[(0,a.jsxs)("div",{children:[r.producer&&(0,a.jsx)("span",{className:"fi fi-".concat(r.producer," mr-2")}),(0,a.jsx)("span",{style:{fontWeight:600},children:c(r.name)})]}),r.author&&(0,a.jsx)("span",{style:{fontSize:12},children:"Author: ".concat(r.author)}),x&&(0,a.jsx)("span",{style:{fontSize:12},children:"Mod: ".concat(x.name)})]})})})},q=n(58199),J=n(94184),G=n.n(J),V=function(e){var t=e.item,n=e.mode,r=e.onItemTaken,o=(0,i._)((0,v.useState)(-1),2),s=o[0],c=o[1],l=(0,v.useContext)(M.Q).scale,d=(0,v.useContext)(q.P).hand,u=(0,i._)((0,v.useState)(),2),h=u[0],m=u[1],f=(0,i._)((0,v.useState)(),2),x=f[0],p=f[1],y=t.skins&&t.skins.length>0,g=s>=0?(0,F.RV)(t,t.skins[s]):t;return(0,a.jsxs)(X,{mode:n,onClick:function(){return r(g)},setTooltipPos:m,setHover:p,onDragStart:function(){return r(g)},children:[(0,a.jsxs)("div",{className:G()("w-full h-full flex items-center justify-center relative","hover:outline hover:outline-1 hover:outline-[#2685BB] dark:hover:outline-[#3d5a6b]","hover:bg-[#DAF1FF] dark:hover:bg-gray-600"),children:[(0,a.jsx)("img",{style:{paddingLeft:40*l,paddingRight:40*l,WebkitTouchCallout:"none",width:"100%",height:"100%",objectFit:"scale-down"},src:g.icon.image,alt:g.name.en}),y&&(0,a.jsxs)("div",{className:"flex flex-row absolute items-center justify-center left-0 top-0 w-full h-full",children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-full absolute cursor-pointer select-none",style:{left:"0",width:40*l},onTouchStart:function(e){return e.stopPropagation()},onClick:function(e){e.preventDefault(),e.stopPropagation(),void 0!==t.skins&&c(-1===s?t.skins.length-1:s-1)},children:(0,a.jsx)("img",{style:{width:20*l,height:20*l},src:"/chevron-left.png"})}),(0,a.jsx)("div",{className:"flex items-center justify-center h-full absolute cursor-pointer select-none",style:{right:0,width:40*l},onTouchStart:function(e){return e.stopPropagation()},onClick:function(e){e.preventDefault(),e.stopPropagation(),void 0!==t.skins&&c(s===t.skins.length-1?-1:s+1)},children:(0,a.jsx)("img",{style:{width:20*l,height:20*l},src:"/chevron-right.png"})})]})]}),void 0===d&&x&&h&&(0,a.jsx)(Q,{item:g,left:h.x,top:h.y})]})},K=["а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я"],$=[["a","o","u"],"b",["v","w"],"g","d",["ye","e","ie","a"],"yo","zh",["z","th","s"],["i","y","ee","ea"],"y",["k","c","q","ck","ch"],"l","m","n",["o","a"],"p","r","s",["t","th"],["u","oo"],["f","ph"],["kh","h"],["ts","c"],"ch",["sh","s"],"shch","y","y",["y",""],"e",["yu","u","ue"],["ya","ja"]],ee=function(e){for(var t=[""],n=0;n<e.length;n++)!function(n){var r=e[n].toLowerCase(),i=K.indexOf(r);if(-1===i)t=t.map(function(e){return e+r});else{var o=$[i];if(Array.isArray(o)){var a,s=[];t.forEach(function(e){o.forEach(function(t){s.push(e+t)})}),(a=t).splice.apply(a,[0,t.length].concat((0,d._)(s)))}else t=t.map(function(e){return e+o})}}(n);return t},et=function(e){var t=e.type,n=e.onItemTaken,r=e.size,i=e.searchTerm,o=(0,v.useContext)(w.p).items,s=(0,v.useContext)(M.Q).scale,c=(0,v.useContext)(R.e4).filters,l=(0,v.useContext)(g.dn),u=l.getTranslation;l.currentLocale;var h=(0,v.useRef)(null);(0,v.useEffect)(function(){h.current&&(h.current.scrollTop=0)},[h,t]);var m=(0,v.useMemo)(function(){var e=(0,R.OE)(o,c);if(i&&i.length>1){var n=ee(i);return e.filter(function(e){var t=e.skins.map(function(t){return(0,F.RV)(e,t)});return[e].concat((0,d._)(t)).some(function(e){var t;return u(e.name).toLowerCase().includes(i.toLowerCase())||n.some(function(t){return e.name.en.toLowerCase().includes(t)})||(null===(t=e.author)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase()))})})}return t?e.filter(function(e){return e.typeId===t.typeId&&(!t.subtypeId||e.subtypeId===t.subtypeId||"other"===t.subtypeId&&!e.subtypeId)}):[]},[o,t,i,c,u]),f=0;switch(r){case"small":f=70;break;case"medium":f=160;break;case"large":f=250}var x=f+80;return(0,a.jsx)("div",{ref:h,className:"h-full w-full",style:{padding:1,overflowY:"scroll",overflowX:"hidden",display:"grid",alignItems:"center",gridTemplateColumns:"repeat(auto-fit, minmax(".concat(Math.floor(x*s),"px, 1fr))"),gridAutoRows:"".concat(90*s,"px")},children:m.map(function(e){return(0,a.jsx)(V,{item:e,onItemTaken:n,mode:"vertical"},"".concat(e.id,"-").concat(e.packId))})})},en=function(e){var t=e.selectedItemType,n=e.onItemTaken,r=e.size,o=e.sourceScreen,s=(0,i._)((0,v.useState)(),2),l=s[0],d=s[1],u=(0,v.useContext)(w.p).categories,h=(0,g.ql)().getTranslation,m=t&&u.flatMap(function(e){return e.types}).find(function(e){return e.id===t.typeId}),f=t&&m&&m.subtypes.find(function(e){return e.id===t.subtypeId}),x=f?"".concat(h(null==m?void 0:m.name)," - ").concat(h(f.name)):"".concat(h(null==m?void 0:m.name));return(0,v.useEffect)(function(){d(void 0)},[t]),(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsx)(H,{title:x,searchTerm:l,setSearchTerm:d,sourceScreen:o}),(0,a.jsx)(et,{type:t,onItemTaken:n,searchTerm:l,size:r}),"showmethesaves"===l&&(0,a.jsx)(c.u,{onDismiss:function(){return d(void 0)},fullscreen:!0,noScroll:!0,children:(0,a.jsx)(ei,{})}),"fixmysavesv2"===l&&(0,a.jsx)(c.u,{onDismiss:function(){return d(void 0)},fullscreen:!0,noScroll:!0,children:(0,a.jsx)(er,{})}),"debugmode"===l&&(0,a.jsx)(c.u,{onDismiss:function(){return d(void 0)},fullscreen:!0,noScroll:!0,children:(0,a.jsx)(y,{})})]})},er=function(){var e,t=(0,i._)((0,v.useState)(!1),2),n=t[0];t[1];var c=(0,b.useRouter)(),d=(e=(0,r._)(function(){var e,t,n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,s.u.get({key:"saves_v2"})];case 1:if(null===(e=r.sent()).value)return alert("No saves v2 found. Cannot proceed"),[2];return t=JSON.parse(e.value),n=(0,l.Z)(t),[4,s.u.set({key:"saves",value:JSON.stringify(n)})];case 2:return r.sent(),alert("Done!"),c.reload(),[2]}})}),function(){return e.apply(this,arguments)});return(0,a.jsxs)("div",{className:"w-full h-full bg-white flex items-center justify-center",children:[(0,a.jsx)("button",{disabled:n,onClick:d,className:"bg-blue-500 rounded p-2 text-white",children:"Fix"}),n&&(0,a.jsx)("span",{children:"Fixing..."})]})},ei=function(){var e=(0,i._)((0,v.useState)([]),2),t=e[0],n=e[1];return(0,v.useEffect)(function(){s.u.get({key:"saves"}).then(function(e){n(e.value?JSON.parse(e.value):"No saves")})},[]),(0,a.jsx)("div",{className:"flex flex-col gap-2 bg-white p-4 w-full h-full overflow-y-scroll",children:(0,a.jsx)("div",{className:"h-full w-full",children:(0,a.jsx)("div",{className:"pb-4",children:JSON.stringify(t,null,2)})})})}},95027:function(e,t,n){n.d(t,{S:function(){return m}});var r=n(24043),i=n(85893),o=n(67294),a=n(7935),s=n(94760),c=n(27842),l=n(53107),d=function(e){var t=e.weapon,n=e.shapeOnly,r=(0,o.useContext)(s.Q).scale;return(0,i.jsx)("div",{style:{position:"absolute",left:0,top:0,transformOrigin:"".concat(41*r,"px ").concat(39*r,"px"),transform:"translate(".concat(21*r,"px, ").concat(68*r,"px) scale(0.44) rotate(20deg)"),filter:n?"brightness(0.0)":void 0},children:(0,i.jsx)(l.q,{item:t})})},u=n(69897),h=n(31900),m=(0,o.forwardRef)(function(e,t){var n,l,m,f=e.inventory,v=e.headIndex,x=e.layer,p=e.bodyPart,y=(0,o.useContext)(a.p).categories,g=(0,r._)((0,c.r)(),2),b=(g[0],g[1]),w=(0,o.useContext)(s.Q).scale,j=(null==p?void 0:p.handType)?"armed"===p.handType:(null===(n=y.flatMap(function(e){return e.types}).find(function(e){return e.id===f.main?.typeId}))||void 0===n?void 0:n.modelType)==="weapon",k=(null==p?void 0:p.handType)?"armed"===p.handType:(null===(m=f.main)||void 0===m?void 0:null===(l=m.properties)||void 0===l?void 0:l.singleHanded)||!1,_=(null==p?void 0:p.weaponModel)||(null==b?void 0:b.weaponModel)||"model",I=(0,u.w)(f,v,j,k),C=I.body,N=I.head,S=I.main,A=I.leftHand,P=I.rightHand;return(0,i.jsxs)("div",{className:"relative",ref:t,style:{width:149*w,height:241*w},children:[(void 0===x||x===h.n6.Body)&&(0,i.jsx)(i.Fragment,{children:C.map(function(e,t){return(0,i.jsx)("img",{src:e,alt:"",className:"absolute"},t)})}),(void 0===x||x===h.n6.Head)&&(0,i.jsx)(i.Fragment,{children:N.map(function(e,t){return(0,i.jsx)("img",{src:e,alt:"",className:"absolute"},t)})}),(void 0===x||x===h.n6.RightHand)&&(0,i.jsx)(i.Fragment,{children:P.map(function(e,t){return(0,i.jsx)("img",{src:e,alt:"",className:"absolute",draggable:"false"},t)})}),(void 0===x||x===h.n6.Weapon)&&(0,i.jsx)(i.Fragment,{children:f.main&&"model"!==_?(0,i.jsx)(d,{weapon:f.main,shapeOnly:"realShaded"===_},"main"):(0,i.jsx)("img",{src:S,alt:"",className:"absolute"},"main")}),(void 0===x||x===h.n6.LeftHand)&&(0,i.jsx)("div",{className:"w-full h-full",children:((null==p?void 0:p.handType)===void 0?A:P).map(function(e,t){return(0,i.jsx)("img",{src:e,alt:"",className:"absolute",style:{transform:(null==p?void 0:p.handType)!==void 0?"translate(".concat(31*w,"px, -").concat(22*w,"px)"):""},draggable:"false"},t)})})]})})},43443:function(e,t,n){n.d(t,{r:function(){return u},u:function(){return d}});var r=n(72253),i=n(14932),o=n(85893),a=n(67294),s=n(94760),c=n(31900),l=n(95027),d=function(e){var t=e.inventory,n=e.bodyPart,r=e.headIndex,i=e.scale,d=void 0===i?1:i,u=e.zIndex,h=e.filter,m=(0,a.useContext)(s.Q).scale,f=n.position,v=n.rotation,x=(0,c.lf)(n.layer);return(0,o.jsx)("div",{className:"absolute select-none pointer-events-none",style:{transform:"translateX(".concat(f.x,"px) translateY(").concat(f.y,"px) scale(").concat(d*n.scale,") "),zIndex:u,filter:h},children:(0,o.jsx)("div",{style:{transformOrigin:x&&"".concat(x.x*m,"px ").concat(x.y*m,"px"),transform:"rotate(".concat(v,"deg)")+(n.isMirrored?" scaleX(-1)":"")},children:(0,o.jsx)(l.S,{inventory:t,headIndex:r,bodyPart:n,layer:n.layer})})},"layer-".concat(n.layer))},u=(0,a.forwardRef)(function(e,t){var n,l=e.inventory,u=e.model,h=e.headIndex,m=(0,a.useContext)(s.Q).scale;return(0,o.jsx)("div",{className:"relative",ref:t,style:{width:149*m,height:241*m},children:(n=u.itemsOrder).map(function(e,t){switch(e){case c.n6.RightHand:case c.n6.LeftHand:case c.n6.Weapon:case c.n6.Body:case c.n6.Head:var a=u.bodyParts.find(function(t){return t.layer===e});return(0,o.jsx)(d,{headIndex:h,bodyPart:(0,i._)((0,r._)({},a),{position:{x:a.position.x*m,y:a.position.y*m}}),inventory:l,zIndex:n.length-t});default:var s=u.attachements.find(function(t){return t.id===e});if(void 0===s)return null;var f=(74.5+s.position.x-s.item.icon.width/2)*m,v=(120.5+s.position.y-s.item.icon.height/2)*m,x=s.item.icon.width*m*s.scale,p=s.item.icon.height*m*s.scale,y=Math.max(x,p),g=-y/s.scale+y;return f-=g/2,v-=g/2,(0,o.jsx)("img",{src:s.item.icon.image,alt:"",draggable:!1,className:"absolute select-none",style:{left:f,top:v,width:x,height:p,minWidth:x,minHeight:p,zIndex:n.length-t,transform:"rotate(".concat(s.rotation,"deg) scaleX(").concat(s.isMirrored?-1:1,")")}},"image-".concat(t))}})})})},85613:function(e,t,n){n.d(t,{KG:function(){return u},LI:function(){return d},Lf:function(){return o},Rr:function(){return i},Vc:function(){return s},dQ:function(){return l},mL:function(){return a},tY:function(){return c}});var r=n(248),i={type:"clothes",imgBody:"/base/model/body_/c_nude.png",imgUnarmed:"/base/model/unarmed_/u_nude.png",imgArmedRight:"/base/model/armed_/a_nude_right.png",imgArmedLeft:"/base/model/armed_/a_nude_left.png"},o=function(e){return{type:"clothes",imgBody:0===e?"/base/model/body_/c_nude_female_1.png":"/base/model/body_/c_nude_female_2.png",imgUnarmed:"/base/model/unarmed_/u_nude_female.png",imgArmedRight:"/base/model/armed_/a_nude_female.png",imgArmedLeft:"/base/model/armed_/a_nude_left.png"}},a={type:"clothes",imgBody:"/base/model/character/body_black_0.png",imgUnarmed:"/base/model/character/unarmed_black_0.png",imgArmedRight:"/base/model/character/armed_right_black_0.png",imgArmedLeft:"/base/model/character/armed_left_black_0.png"},s=function(e){switch(e){case"A":case"B":case"C":case"D":case"E":return{body:"/base/model/character/cloth_body_black_".concat(e,".png")};default:return{}}},c=function(e){switch(e){case"A":return{unarmed:"/base/model/character/cloth_unarmed_black_A.png",armedRight:"/base/model/character/cloth_armed_right_black_A.png",armedLeft:"/base/model/character/cloth_armed_left_black_A.png"};case"B":return{unarmed:"/base/model/character/cloth_unarmed_black_B.png",armedRight:"/base/model/character/cloth_armed_right_black_B.png",armedLeft:"/base/model/character/cloth_armed_left_black_A.png"};case"C":return{unarmed:"/base/model/character/unarmed_black_0.png",armedRight:"/base/model/character/armed_right_black_0.png",armedLeft:"/base/model/character/armed_left_black_0.png"};default:return{}}},l=["head_female_1.png","head_female_2.png"],d=["head_black_0.png"],u=["head_a.png","head_b.png","head_c.png","head_d.png","head_e.png","head_f.png","head_g.png","head_h.png"].concat((0,r._)(l),(0,r._)(d))},69897:function(e,t,n){n.d(t,{w:function(){return o}});var r=n(248),i=n(85613),o=function(e,t,n,o){var a,s,c,l,d=e.clothes,u=e.main,h=e.helmet,m=e.vest,f=e.backpack,v=e.pouch,x=e.armour,p=e.eyes,y=e.mask,g=e.radio,b=e.patch,w=e.pockets,j=[],k=[],_=[],I=[],C=i.KG[t],N=i.dQ.indexOf(C),S=i.LI.indexOf(C);l=N>=0?(0,i.Lf)(N):S>=0?i.mL:i.Rr;var A={},P={};S>=0&&d&&d.length>0&&(null===(a=d[0].model)||void 0===a?void 0:a.type)==="clothes"&&(d[0].model.bodySkinPattern&&(A=(0,i.Vc)(d[0].model.bodySkinPattern)),d[0].model.armsSkinPattern&&(P=(0,i.tY)(d[0].model.armsSkinPattern))),null==f||f.forEach(function(e){var t;j.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),d&&d.length>0?d.forEach(function(e){var t,n,r,i;(null===(t=e.model)||void 0===t?void 0:t.type)==="clothes"&&(null===(n=e.model)||void 0===n?void 0:n.imgLowerBody)&&j.push(null===(i=e.model)||void 0===i?void 0:i.imgLowerBody),j.push(null===(r=e.model)||void 0===r?void 0:r.imgBody)}):j.push(l.imgBody),j.push(A.body),null==x||x.forEach(function(e){var t,n,r,i;(null===(t=e.model)||void 0===t?void 0:t.type)==="armor"&&(null===(n=e.model)||void 0===n?void 0:n.imgLowerBody)&&j.push(null===(i=e.model)||void 0===i?void 0:i.imgLowerBody),j.push(null===(r=e.model)||void 0===r?void 0:r.imgBody)}),w.forEach(function(e){null==e||e.forEach(function(e){var t,n;(null===(t=e.model)||void 0===t?void 0:t.type)==="footwear"&&j.push(null===(n=e.model)||void 0===n?void 0:n.imgBody)})}),null==m||m.forEach(function(e){var t;j.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==f||f.forEach(function(e){var t,n;(null===(t=e.model)||void 0===t?void 0:t.type)==="backpack"&&j.push(null===(n=e.model)||void 0===n?void 0:n.imgStraps)}),null==y||y.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="mask"&&j.push(e.model.imgBag)}),null==v||v.forEach(function(e){var t;j.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==h||h.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="helmet"&&k.push(e.model.imgBack)}),k.push("/base/model/head_/".concat(C)),null==y||y.forEach(function(e){var t;k.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==g||g.forEach(function(e){var t;k.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==h||h.forEach(function(e){var t;k.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==p||p.forEach(function(e){var t;k.push(null===(t=e.model)||void 0===t?void 0:t.imgBody)}),null==d||d.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="clothes"&&k.push(e.model.imgHood)}),null==x||x.forEach(function(e){var t,n;(null===(t=e.model)||void 0===t?void 0:t.type)==="armor"&&k.push(null===(n=e.model)||void 0===n?void 0:n.imgHood)});var L=function(e){n?o?(I.push(e.imgArmedRight),I.push(P.armedRight)):(_.push(e.imgArmedLeft),_.push(P.armedLeft),I.push(e.imgArmedRight),I.push(P.armedRight)):(I.push(e.imgUnarmed),I.push(P.unarmed))};return d&&d.length>0?d.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="clothes"&&L(e.model)}):L(l),null==x||x.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="armor"&&(n?(o||_.push(e.model.imgArmedLeft),I.push(e.model.imgArmedRight)):I.push(e.model.imgUnarmed))}),null==b||b.forEach(function(e){var t,r;(null===(t=e.model)||void 0===t?void 0:t.type)==="patch"&&I.push(n?e.model.imgArmed:e.model.imgUnarmed),(null===(r=e.model)||void 0===r?void 0:r.type)==="gloves"&&L(e.model)}),w.forEach(function(e){null==e||e.forEach(function(e){var t;(null===(t=e.model)||void 0===t?void 0:t.type)==="gloves"&&L(e.model)})}),{body:j.filterNotUndefined(),head:k.filterNotUndefined(),main:null==u?void 0:null===(s=u.model)||void 0===s?void 0:s.imgBody,leftHand:_.filterNotUndefined(),rightHand:I.filterNotUndefined(),images:(0,r._)(j).concat((0,r._)(k),[null==u?void 0:null===(c=u.model)||void 0===c?void 0:c.imgBody],(0,r._)(_),(0,r._)(I)).filterNotUndefined()}}},58231:function(e,t,n){n.d(t,{BC:function(){return c},dc:function(){return a},sl:function(){return s}});var r=n(77236),i=n(94478),o=n(14416),a=(0,r.xC)({reducer:{inventory:i.ZP}}),s=function(){return(0,o.I0)()},c=o.v9},27842:function(e,t,n){n.d(t,{r:function(){return o}});var r=n(67294),i=n(34979),o=function(){var e=r.useContext(i.$),t=e.settings;return[e.isLoading,t,e.setSettings]}},64022:function(e,t,n){n.d(t,{p:function(){return v}});var r=n(72253),i=n(14932),o=n(24043),a=n(248),s=n(85893),c=n(32807),l=n(85634),d=n(67294),u=n(7935),h=n(94760),m=n(78726),f=n(43537),v=function(e){var t=e.selectedType,n=e.onTypeSelected,h=(0,c.ql)(),m=h.getTranslation;h.t;var v=(0,d.useContext)(u.p),p=v.items,y=v.categories,g=(0,d.useContext)(f.e4),b=g.filters;g.setFilters;var w=(0,o._)((0,d.useState)([]),2),j=w[0],k=w[1],_=(0,d.useMemo)(function(){var e=(0,f.OE)(p,b);return y.map(function(t){return(0,i._)((0,r._)({},t),{types:t.types.map(function(t){var n=t.subtypes.filter(function(n){return e.some(function(e){return e.typeId===t.id&&e.subtypeId===n.id})}),o=e.some(function(e){return e.typeId===t.id&&void 0===e.subtypeId}),s=(0,a._)(n);return o&&s.length>0&&s.push({id:"other",name:l.I.categoryOther}),(0,i._)((0,r._)({},t),{subtypes:s})})})}).filter(function(e){return e.types.length>0})},[y,p,b]),I=function(e){C(e),n({typeId:e.id})},C=function(e){k(function(t){return t.includes(e.id)?t.filter(function(t){return t!==e.id}):(0,a._)(t).concat([e.id])})};return(0,s.jsx)("div",{className:"h-full flex flex-col",children:_.map(function(e){return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"text-base font-bold text-center bg-panel",children:m(e.name)}),(0,s.jsx)("div",{className:"flex flex-col flex-wrap justify-stretch",children:e.types.map(function(e){var r=e.subtypes.length>0;return(0,s.jsxs)(d.Fragment,{children:[(0,s.jsx)(x,{title:m(e.name),expanded:j.includes(e.id),hasSubtypes:r,isSubtype:!1,selected:!!t&&t.typeId===e.id&&void 0===t.subtypeId,onClick:function(){return I(e)},onExpandClick:function(){return C(e)}},e.name.en),r&&j.includes(e.id)&&e.subtypes.map(function(r){return(0,s.jsx)(x,{title:m(r.name),hasSubtypes:!1,isSubtype:!0,selected:!!t&&t.typeId===e.id&&t.subtypeId===r.id,onClick:function(){return n({typeId:e.id,subtypeId:r.id})}},r.id)})]},e.name.en)})})]},e.name.en)})})},x=function(e){var t=e.title,n=e.onClick,r=e.onExpandClick,i=e.hasSubtypes,o=e.expanded,a=e.selected,c=e.isSubtype;(0,d.useContext)(h.Q).scale;var l=(0,m.v)()||(0,m.T)()?30:20;return(0,s.jsxs)("div",{className:"".concat("flex flex-row cursor-pointer items-center"," ").concat(a?"font-bold bg-[#a0a367] dark:bg-slate-600":"hover:bg-[#a0a367aa] dark:hover:bg-slate-700 hover:bg-opacity-80"),style:{minHeight:(0,m.v)()||(0,m.T)()?40:void 0},children:[i?(0,s.jsx)("div",{onClick:r,className:"hover:bg-[#00000022]",style:{backgroundImage:o?"url(/arrow_drop_down_FILL0_wght400_GRAD0_opsz48.svg)":"url(/arrow_right_FILL0_wght400_GRAD0_opsz48.svg)",backgroundSize:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center",height:l,width:l}}):(0,s.jsx)("div",{className:"shrink-0",style:{width:c?30:20}}),(0,s.jsx)("span",{className:"text-sm flex-1",onClick:n,children:t})]})}},81069:function(e,t,n){n.d(t,{q:function(){return i}});var r=n(67294),i=function(e){var t=(0,r.useCallback)(function(t){"Escape"===t.key&&e()},[e]);(0,r.useEffect)(function(){return document.addEventListener("keyup",t,!1),function(){document.removeEventListener("keyup",t,!1)}},[t])}},77245:function(e,t,n){n.d(t,{k:function(){return o}});var r=n(24043),i=n(67294),o=function(){var e=(0,r._)((0,i.useState)({x:0,y:0}),2),t=e[0],n=e[1];return(0,i.useEffect)(function(){var e=function(e){n({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),function(){window.removeEventListener("mousemove",e)}},[]),t}},94760:function(e,t,n){n.d(t,{Q:function(){return y},j:function(){return g}});var r=n(11010),i=n(24043),o=n(70655),a=n(85893),s=n(16233),c=n(27842),l=n(67294),d=n(78726),u=n(48564),h=n(18007),m=n(53304),f=n(29895),v=(0,f.fo)("ScreenSize",{web:function(){return new x}}),x=function(e){(0,h._)(n,e);var t=(0,m._)(n);function n(){return(0,u._)(this,n),t.apply(this,arguments)}return n.prototype.screenSize=function(){return(0,r._)(function(){return(0,o.Jh)(this,function(e){return[2,{width:window.innerWidth,height:window.innerHeight}]})})()},n}(f.Uw),p=n(17566),y=l.createContext({scale:1,isSavingImage:!1}),g=function(e){var t=e.children,n=(0,p.p)(),u=(0,i._)((0,c.r)(),2),h=(u[0],u[1]),m=(0,i._)((0,l.useState)(1),2),f=m[0],x=m[1],g=h?(0,s.b)(h.inventoryTemplate).height:650;return(0,l.useEffect)(function(){var e;(e=(0,r._)(function(){var e,t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:if(!(0,d.v)())return[3,2];return[4,v.screenSize()];case 1:x((t=Math.min(Math.min((e=r.sent()).width,e.height),Math.min(n.innerWidth,n.innerHeight)))<g?t/g:1),r.label=2;case 2:return[2]}})}),function(){return e.apply(this,arguments)})()},[g,n]),(0,l.useEffect)(function(){(0,d.v)()||x(n.innerHeight<g?n.innerHeight/g:1)},[n,g,h]),(0,a.jsx)(y.Provider,{value:{scale:f,isSavingImage:!1},children:t})}},53107:function(e,t,n){n.d(t,{q:function(){return c},s:function(){return s}});var r=n(248),i=n(85893),o=n(67294),a=n(94760),s=function(e){var t=Number.MAX_VALUE,n=Number.MAX_VALUE,r=Number.MIN_VALUE,i=Number.MIN_VALUE;return e&&(t=-e.icon.width/2,r=e.icon.width/2,n=-e.icon.height/2,i=e.icon.height/2),e&&e.attachements&&e.attachements&&e.attachements.forEach(function(e){var o=e.position.x-e.item.icon.width/2;o<t&&(t=o);var a=e.position.x+e.item.icon.width/2;a>r&&(r=a);var s=e.position.y-e.item.icon.height/2;s<n&&(n=s);var c=e.position.y+e.item.icon.height/2;c>i&&(i=c)}),{minX:t,maxX:r,minY:n,maxY:i,width:r-t,height:i-n}},c=function(e){var t,n=e.item,c=s(n),l=(0,o.useContext)(a.Q).scale,d=0,u=0;if(n){var h=s(n),m=h.minX,f=(h.maxX,h.minY);h.maxY,h.width,h.height,d=-m-n.icon.width/2,u=-f-n.icon.height/2}return(0,i.jsx)("div",{className:"select-none touch-none pointer-events-none relative isolate",style:{width:c.width*l,height:c.height*l},children:n&&(t=n.itemsOrder||["item"].concat((0,r._)(n.attachements||[]))).map(function(e,r){if("item"===e)return(0,i.jsx)("img",{className:"absolute select-none",style:{left:d*l,top:u*l,width:n.icon.width*l,height:n.icon.height*l,zIndex:t.length-r},src:n.icon.image,alt:"",draggable:!1},"image-".concat(e));var o,a=null===(o=n.attachements)||void 0===o?void 0:o.find(function(t){return t.id===e});if(void 0===a)return null;var s=(d+n.icon.width/2+a.position.x-a.item.icon.width/2)*l,c=(u+n.icon.height/2+a.position.y-a.item.icon.height/2)*l,h=a.item.icon.width*l*a.scale,m=a.item.icon.height*l*a.scale,f=Math.max(h,m),v=-f/a.scale+f;return s-=v/2,c-=v/2,(0,i.jsx)("img",{src:a.item.icon.image,alt:"",draggable:!1,className:"absolute select-none",style:{left:s,top:c,width:h,height:m,zIndex:t.length-r,transform:"rotate(".concat(a.rotation,"deg) scaleX(").concat(a.isMirrored?-1:1,")")}},"image-".concat(r))})})}},14975:function(e,t,n){n.d(t,{F3:function(){return a},Kn:function(){return o},RV:function(){return s},nP:function(){return c}});var r=n(72253),i=n(14932),o=["clothes","item","weapon","backpack","armor","patch","mask","helmet","gloves","footwear","lowerBody"],a={id:-1,typeId:"",name:{en:""},icon:{image:"",width:60,height:60},skins:[]},s=function(e,t){var n,o,a,s,c,l,d,u,h,m,f,v,x,p,y,g,b,w,j;switch(null===(n=e.model)||void 0===n?void 0:n.type){case"clothes":c=(0,i._)((0,r._)({type:"clothes"},t.model),{imgBody:(null===(l=t.model)||void 0===l?void 0:l.imgBody)||e.model.imgBody,imgUnarmed:(null===(d=t.model)||void 0===d?void 0:d.imgUnarmed)||e.model.imgUnarmed,imgArmedLeft:(null===(u=t.model)||void 0===u?void 0:u.imgArmedLeft)||e.model.imgArmedLeft,imgArmedRight:(null===(h=t.model)||void 0===h?void 0:h.imgArmedRight)||e.model.imgArmedRight});break;case"item":c=(0,i._)((0,r._)({type:"item"},t.model),{imgBody:(null===(m=t.model)||void 0===m?void 0:m.imgBody)||e.model.imgBody});break;case"weapon":c=(0,i._)((0,r._)({type:"weapon"},t.model),{imgBody:(null===(f=t.model)||void 0===f?void 0:f.imgBody)||e.model.imgBody});break;case"backpack":c=(0,i._)((0,r._)({type:"backpack"},t.model),{imgBody:(null===(v=t.model)||void 0===v?void 0:v.imgBody)||e.model.imgBody});break;case"armor":c=(0,r._)({type:"armor"},t.model);break;case"patch":c=(0,r._)({type:"patch"},t.model);break;case"mask":c=(0,i._)((0,r._)({type:"mask"},t.model),{imgBody:(null===(x=t.model)||void 0===x?void 0:x.imgBody)||e.model.imgBody});break;case"helmet":c=(0,i._)((0,r._)({type:"helmet"},t.model),{imgBody:(null===(p=t.model)||void 0===p?void 0:p.imgBody)||e.model.imgBody});break;case"gloves":c=(0,i._)((0,r._)({type:"gloves"},t.model),{imgArmedRight:(null===(y=t.model)||void 0===y?void 0:y.imgArmedRight)||e.model.imgArmedRight,imgArmedLeft:(null===(g=t.model)||void 0===g?void 0:g.imgArmedLeft)||e.model.imgArmedLeft,imgUnarmed:(null===(b=t.model)||void 0===b?void 0:b.imgUnarmed)||e.model.imgUnarmed});break;case"footwear":c=(0,i._)((0,r._)({type:"footwear"},t.model),{imgBody:(null===(w=t.model)||void 0===w?void 0:w.imgBody)||e.model.imgBody});break;case"lowerBody":c=(0,i._)((0,r._)({type:"lowerBody"},t.model),{imgBody:(null===(j=t.model)||void 0===j?void 0:j.imgBody)||e.model.imgBody})}return(0,i._)((0,r._)({},e),{skinId:t.id,icon:t.icon,name:{en:(null===(o=t.name)||void 0===o?void 0:o.en)||e.name.en,ru:(null===(a=t.name)||void 0===a?void 0:a.ru)||e.name.ru,cn:(null===(s=t.name)||void 0===s?void 0:s.cn)||e.name.cn},author:t.author||e.author,packId:t.packId||e.packId,model:c})},c="custom"},31900:function(e,t,n){n.d(t,{CS:function(){return a},lf:function(){return o},n6:function(){return i}});var r,i,o=function(e){switch(e){case i.LeftHand:return{x:75,y:75};case i.RightHand:return{x:38,y:87};case i.Weapon:return{x:75,y:106};case i.Head:return{x:63,y:54};default:return{x:0,y:0}}};(r=i||(i={})).Head="head",r.Body="body",r.Weapon="weapon",r.RightHand="right-hand",r.LeftHand="left-hand";var a={attachements:[],itemsOrder:[i.RightHand,i.LeftHand,i.Weapon,i.Head,i.Body],bodyParts:[{layer:i.Body,rotation:0,scale:1,position:{x:0,y:0},isMirrored:!1},{layer:i.Head,rotation:0,scale:1,position:{x:0,y:0},isMirrored:!1},{layer:i.LeftHand,rotation:0,scale:1,position:{x:0,y:0},isMirrored:!1},{layer:i.RightHand,rotation:0,scale:1,position:{x:0,y:0},isMirrored:!1},{layer:i.Weapon,rotation:0,scale:1,position:{x:0,y:0},isMirrored:!1}]}},25594:function(e,t,n){n.d(t,{h:function(){return r},u:function(){return i}});var r=[{code:"su",name:{en:"Soviet Union",ru:"Советский Союз"}},{code:"ru",name:{en:"Russia",ru:"Россия"}},{code:"us",name:{en:"United States",ru:"Соединенные Штаты"}},{code:"af",name:{en:"Afghanistan",ru:"Афганистан"}},{code:"al",name:{en:"Albania",ru:"Албания"}},{code:"am",name:{en:"Armenia",ru:"Армения"}},{code:"ao",name:{en:"Angola",ru:"Ангола"}},{code:"ar",name:{en:"Argentina",ru:"Аргентина"}},{code:"au",name:{en:"Australia",ru:"Австралия"}},{code:"at",name:{en:"Austria",ru:"Австрия"}},{code:"az",name:{en:"Azerbaijan",ru:"Азербайджан"}},{code:"bd",name:{en:"Bangladesh",ru:"Бангладеш"}},{code:"be",name:{en:"Belgium",ru:"Бельгия"}},{code:"bg",name:{en:"Bulgaria",ru:"Болгария"}},{code:"bh",name:{en:"Bahrain",ru:"Бахрейн"}},{code:"br",name:{en:"Brazil",ru:"Бразилия"}},{code:"by",name:{en:"Belarus",ru:"Беларусь"}},{code:"ca",name:{en:"Canada",ru:"Канада"}},{code:"ch",name:{en:"Switzerland",ru:"Швейцария"}},{code:"cn",name:{en:"China",ru:"Китай"}},{code:"co",name:{en:"Colombia",ru:"Колумбия"}},{code:"cz",name:{en:"Czech Republic",ru:"Чехия"}},{code:"de",name:{en:"Germany",ru:"Германия"}},{code:"gdr",name:{en:"East Germany",ru:"ГДР"}},{code:"dk",name:{en:"Denmark",ru:"Дания"}},{code:"dz",name:{en:"Algeria",ru:"Алжир"}},{code:"ee",name:{en:"Estonia",ru:"Эстония"}},{code:"eg",name:{en:"Egypt",ru:"Египет"}},{code:"es",name:{en:"Spain",ru:"Испания"}},{code:"et",name:{en:"Ethiopia",ru:"Эфиопия"}},{code:"fi",name:{en:"Finland",ru:"Финляндия"}},{code:"fr",name:{en:"France",ru:"Франция"}},{code:"gb",name:{en:"United Kingdom",ru:"Великобритания"}},{code:"ge",name:{en:"Georgia",ru:"Грузия"}},{code:"gr",name:{en:"Greece",ru:"Греция"}},{code:"gy",name:{en:"Guyana",ru:"Гайана"}},{code:"hr",name:{en:"Croatia",ru:"Хорватия"}},{code:"hu",name:{en:"Hungary",ru:"Венгрия"}},{code:"id",name:{en:"Indonesia",ru:"Индонезия"}},{code:"ie",name:{en:"Ireland",ru:"Ирландия"}},{code:"il",name:{en:"Israel",ru:"Израиль"}},{code:"in",name:{en:"India",ru:"Индия"}},{code:"is",name:{en:"Iceland",ru:"Исландия"}},{code:"iq",name:{en:"Iraq",ru:"Ирак"}},{code:"ir",name:{en:"Iran",ru:"Иран"}},{code:"it",name:{en:"Italy",ru:"Италия"}},{code:"jp",name:{en:"Japan",ru:"Япония"}},{code:"kg",name:{en:"Kyrgyzstan",ru:"Киргизия"}},{code:"kh",name:{en:"Cambodia",ru:"Камбоджа"}},{code:"kz",name:{en:"Kazakhstan",ru:"Казахстан"}},{code:"kp",name:{en:"North Korea",ru:"Северная Корея"}},{code:"kr",name:{en:"South Korea",ru:"Южная Корея"}},{code:"la",name:{en:"Laos",ru:"Лаос"}},{code:"li",name:{en:"Liechtenstein",ru:"Лихтенштейн"}},{code:"lt",name:{en:"Lithuania",ru:"Литва"}},{code:"lv",name:{en:"Latvia",ru:"Латвия"}},{code:"ly",name:{en:"Libya",ru:"Ливия"}},{code:"ma",name:{en:"Morocco",ru:"Марокко"}},{code:"md",name:{en:"Moldova",ru:"Молдова"}},{code:"ml",name:{en:"Mali",ru:"Мали"}},{code:"mm",name:{en:"Myanmar",ru:"Мьянма"}},{code:"mx",name:{en:"Mexico",ru:"Мексика"}},{code:"my",name:{en:"Malaysia",ru:"Малайзия"}},{code:"mz",name:{en:"Mozambique",ru:"Мозамбик"}},{code:"ng",name:{en:"Nigeria",ru:"Нигерия"}},{code:"nl",name:{en:"Netherlands",ru:"Нидерланды"}},{code:"no",name:{en:"Norway",ru:"Норвегия"}},{code:"pa",name:{en:"Panama",ru:"Панама"}},{code:"ph",name:{en:"Philippines",ru:"Филиппины"}},{code:"pk",name:{en:"Pakistan",ru:"Пакистан"}},{code:"pl",name:{en:"Poland",ru:"Польша"}},{code:"ps",name:{en:"Palestine",ru:"Палестина"}},{code:"ro",name:{en:"Romania",ru:"Румыния"}},{code:"rs",name:{en:"Serbia",ru:"Сербия"}},{code:"sa",name:{en:"Saudi Arabia",ru:"Саудовская Аравия"}},{code:"se",name:{en:"Sweden",ru:"Швеция"}},{code:"si",name:{en:"Slovenia",ru:"Словения"}},{code:"sk",name:{en:"Slovakia",ru:"Словакия"}},{code:"sy",name:{en:"Syria",ru:"Сирия"}},{code:"th",name:{en:"Thailand",ru:"Таиланд"}},{code:"tj",name:{en:"Tajikistan",ru:"Таджикистан"}},{code:"tm",name:{en:"Turkmenistan",ru:"Туркменистан"}},{code:"tr",name:{en:"Turkey",ru:"Турция"}},{code:"ua",name:{en:"Ukraine",ru:"Украина"}},{code:"uz",name:{en:"Uzbekistan",ru:"Узбекистан"}},{code:"ve",name:{en:"Venezuela",ru:"Венесуэла"}},{code:"vn",name:{en:"Vietnam",ru:"Вьетнам"}},{code:"ye",name:{en:"Yemen",ru:"Йемен"}},{code:"za",name:{en:"South Africa",ru:"Южная Африка"}},{code:"zw",name:{en:"Zimbabwe",ru:"Зимбабве"}},{code:"unk",name:{en:"Unknown",ru:"Неизвестно"}}],i=r.map(function(e){return e.code})},61649:function(e,t,n){n.d(t,{N:function(){return i},Z:function(){return r}});var r=function(e,t){var n=new FileReader;n.onload=function(){var e=n.result;if(e&&"string"==typeof e){var r=new Image;r.onload=function(){t(r,e)},r.src=e}},n.readAsDataURL(e)},i=function(e,t,n){var r=new FileReader;r.onload=function(e){var r,i=document.createElement("img");i.onload=function(){var e=document.createElement("canvas"),r=e.getContext("2d");if(r){var o=i.width>t.width||i.height>t.height?Math.min(t.width/i.width,t.height/i.height):1;e.width=i.width*o,e.height=i.height*o,r.drawImage(i,0,0,e.width,e.height),n(e.toDataURL(),e.width,e.height)}},i.src=null===(r=e.target)||void 0===r?void 0:r.result},r.readAsDataURL(e)}},17566:function(e,t,n){n.d(t,{p:function(){return o}});var r=n(24043),i=n(67294),o=function(){var e=(0,r._)((0,i.useState)({width:0,height:0,innerHeight:0,innerWidth:0}),2),t=e[0],n=e[1];return(0,i.useEffect)(function(){var e=function(){n({width:"undefined"!=typeof document&&document.body.clientWidth||0,height:"undefined"!=typeof document&&document.body.clientHeight||0,innerHeight:window.innerHeight||0,innerWidth:window.innerWidth||0})};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}},[]),t}}}]);