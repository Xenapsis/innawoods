"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7846],{70911:function(e,n,t){t.d(n,{P:function(){return c}});var r=t(24043),s=t(85893),i=t(67294),l=t(77245),o=t(53107),a=t(94760),c=function(e){var n=e.item,t=(0,i.useContext)(a.Q).scale,c=(0,l.k)(),d=(0,r._)((0,i.useState)(),2),u=d[0],f=d[1],m=(0,i.useCallback)(function(e){f({x:e.clientX,y:e.clientY})},[]),x=(0,i.useCallback)(function(e){f({x:e.clientX,y:e.clientY})},[]);(0,i.useEffect)(function(){return window.addEventListener("pointerdown",x),window.addEventListener("pointermove",m),function(){window.removeEventListener("pointerdown",x),window.removeEventListener("pointermove",m)}},[]),(0,i.useEffect)(function(){return console.debug("mounted"),function(){console.debug("unmount")}},[]);var h=(null==u?void 0:u.x)||c.x,v=(null==u?void 0:u.y)||c.y,p=(null==n?void 0:n.icon.width)||0,b=(null==n?void 0:n.icon.height)||0,j=n?h-n.icon.width/2*t:0,g=n?v-n.icon.height/2*t:0;return(0,s.jsx)("div",{id:"hand",style:{left:0,top:0,width:p*t,height:b*t,position:"fixed",pointerEvents:"none",touchAction:"none",transform:"translate(".concat(j,"px, ").concat(g,"px)"),transformOrigin:"left top",zIndex:99999},children:n?(0,s.jsx)(o.q,{item:n}):null})}},67846:function(e,n,t){t.d(n,{H:function(){return ey}});var r=t(85893),s=t(67294),i=t(7935),l=t(78726),o=t(70911),a=t(58199),c=t(24043),d=t(94760),u=t(11010),f=t(72253),m=t(14932),x=t(248),h=t(70655),v=t(77236),p=t(18726),b=t(81069),j=t(97169),g=function(e){var n=e.title,t=e.message,s=e.onConfirm,i=e.onCancel;return(0,b.q)(i),(0,r.jsx)(j.u,{fullscreen:!0,noScroll:!0,onDismiss:i,children:(0,r.jsxs)("div",{className:"bg-itemList border border-black flex flex-col items-center p-4",children:[(0,r.jsx)("h1",{className:"font-bold text-xl",children:n}),(0,r.jsx)("p",{className:"my-4 whitespace-pre-line text-center",children:t}),(0,r.jsxs)("div",{className:"flex flex-row gap-16",children:[(0,r.jsx)(p.z,{className:"px-6 py-1",onClick:s,children:"Yes"}),(0,r.jsx)(p.z,{className:"px-6 py-1",onClick:i,children:"No"})]})]})})},w=t(32807),y=t(43537),N=t(94478),k=t(43443),C=t(58231),S=t(14975),_=t(31900),I=function(e,n){var t=n.find(function(n){return n.id===e.itemId});if(t){var r=t.skins.find(function(n){return n.id===e.skinId});return{id:e.id,item:r?(0,S.RV)(t,r):t,position:e.position,rotation:e.rotation||0,scale:e.scale||1,isMirrored:e.isMirrored||!1}}if(e.icon)return{id:e.id,item:{id:e.itemId,icon:e.icon,typeId:S.nP,name:{en:"Custom"},packId:"custom",skins:[]},position:e.position,rotation:e.rotation||0,scale:e.scale||1,isMirrored:e.isMirrored||!1}},M=function(e,n){var t=n.find(function(n){return n.id===e.id});if(void 0===t)return(0,m._)((0,f._)({},S.F3),{id:e.id});var r=t.skins.find(function(n){return n.id===e.skinId}),s=(0,m._)((0,f._)({},t),{attachements:e.attachements&&e.attachements.map(function(e){return I(e,n)}).filterNotUndefined(),itemsOrder:e.itemsOrder,properties:e.properties});return r?(0,S.RV)(s,r):s},L=function(e,n){var t,r,s,i,l,o,a,c,d,u;return{main:e.main&&M(e.main,n),sub1:e.sub1&&M(e.sub1,n),sub2:e.sub2&&M(e.sub2,n),vest:null===(t=e.vest)||void 0===t?void 0:t.map(function(e){return M(e,n)}).filterNotUndefined(),pouch:null===(r=e.pouch)||void 0===r?void 0:r.map(function(e){return M(e,n)}).filterNotUndefined(),backpack:null===(s=e.backpack)||void 0===s?void 0:s.map(function(e){return M(e,n)}).filterNotUndefined(),patch:null===(i=e.patch)||void 0===i?void 0:i.map(function(e){return M(e,n)}).filterNotUndefined(),helmet:null===(l=e.helmet)||void 0===l?void 0:l.map(function(e){return M(e,n)}).filterNotUndefined(),armour:null===(o=e.armour)||void 0===o?void 0:o.map(function(e){return M(e,n)}).filterNotUndefined(),clothes:null===(a=e.clothes)||void 0===a?void 0:a.map(function(e){return M(e,n)}).filterNotUndefined(),eyes:null===(c=e.eyes)||void 0===c?void 0:c.map(function(e){return M(e,n)}).filterNotUndefined(),mask:null===(d=e.mask)||void 0===d?void 0:d.map(function(e){return M(e,n)}).filterNotUndefined(),radio:null===(u=e.radio)||void 0===u?void 0:u.map(function(e){return M(e,n)}).filterNotUndefined(),scope:e.scope&&M(e.scope,n),barrelBottom:e.barrelBottom&&M(e.barrelBottom,n),barrelSide:e.barrelSide&&M(e.barrelSide,n),muzzle:e.muzzle&&M(e.muzzle,n),vestCells:e.vestCells.map(function(e){return null===e?[]:e.map(function(e){return e&&M(e,n)}).filterNotUndefined()}),pouchCells:e.pouchCells.map(function(e){return null===e?[]:e.map(function(e){return e&&M(e,n)}).filterNotUndefined()}),backpackCells:e.backpackCells.map(function(e){return null===e?[]:e.map(function(e){return e&&M(e,n)}).filterNotUndefined()}),pockets:e.pockets.map(function(e){return null===e?[]:e.map(function(e){return e&&M(e,n)}).filterNotUndefined()})}},E=function(e,n){var t;return{id:e.id,name:e.name,inventory:L(e.inventory,n),headIndex:e.headIndex,model:e.model?{itemsOrder:(t=e.model).itemsOrder,attachements:t.attachements.map(function(e){return I(e,n)}).filterNotUndefined(),bodyParts:t.bodyParts}:_.CS}},z=function(e){return{id:e.id,itemId:e.item.id,skinId:e.item.skinId,position:e.position,rotation:e.rotation,scale:e.scale,isMirrored:e.isMirrored,icon:e.item.typeId===S.nP?e.item.icon:void 0}},D=function(e){return{id:e.id,skinId:e.skinId,attachements:e.attachements&&e.attachements.map(z),itemsOrder:e.itemsOrder,properties:e.properties}},T=function(e){var n,t,r,s,i,l,o,a,c,d;return{main:e.main&&D(e.main),sub1:e.sub1&&D(e.sub1),sub2:e.sub2&&D(e.sub2),vest:null===(n=e.vest)||void 0===n?void 0:n.map(function(e){return D(e)}),pouch:null===(t=e.pouch)||void 0===t?void 0:t.map(function(e){return D(e)}),backpack:null===(r=e.backpack)||void 0===r?void 0:r.map(function(e){return D(e)}),patch:null===(s=e.patch)||void 0===s?void 0:s.map(function(e){return D(e)}),helmet:null===(i=e.helmet)||void 0===i?void 0:i.map(function(e){return D(e)}),armour:null===(l=e.armour)||void 0===l?void 0:l.map(function(e){return D(e)}),clothes:null===(o=e.clothes)||void 0===o?void 0:o.map(function(e){return D(e)}),eyes:null===(a=e.eyes)||void 0===a?void 0:a.map(function(e){return D(e)}),mask:null===(c=e.mask)||void 0===c?void 0:c.map(function(e){return D(e)}),radio:null===(d=e.radio)||void 0===d?void 0:d.map(function(e){return D(e)}),scope:e.scope&&D(e.scope),barrelBottom:e.barrelBottom&&D(e.barrelBottom),barrelSide:e.barrelSide&&D(e.barrelSide),muzzle:e.muzzle&&D(e.muzzle),vestCells:e.vestCells.map(function(e){return e?e.map(function(e){return e&&D(e)}):null}),pouchCells:e.pouchCells.map(function(e){return e?e.map(function(e){return e&&D(e)}):null}),backpackCells:e.backpackCells.map(function(e){return e?e.map(function(e){return e&&D(e)}):null}),pockets:e.pockets.map(function(e){return e?e.map(function(e){return e&&D(e)}):null})}},P=function(e){var n;return{id:e.id,name:e.name,inventory:T(e.inventory),headIndex:e.headIndex,model:{itemsOrder:(n=e.model).itemsOrder,attachements:n.attachements.map(z),bodyParts:n.bodyParts}}},U=t(73842),Z=function(e){var n=e.save,t=e.onSave,l=e.onLoad,o=e.onDelete,a=e.onRename,u=(0,s.useContext)(i.p).items,f=(0,w.ql)().t,m=(0,s.useContext)(d.Q).scale,x=(0,c._)((0,s.useMemo)(function(){try{return[E(n,u)]}catch(e){return console.error(e),[null,e]}},[n,u]),2),h=x[0],v=x[1];return null===h?(0,r.jsx)("div",{className:"w-full flex flex-row items-stretch relative bg-panel",children:(0,r.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center gap-4",children:[(0,r.jsx)("span",{className:"text-xl font-bold",children:"Save failed to load"}),(0,r.jsx)("span",{children:n.name}),(0,r.jsxs)("span",{children:["Error: ",v.message]})]})}):(0,r.jsxs)("div",{className:"w-full flex flex-row items-stretch relative bg-panel",children:[(0,r.jsx)("div",{className:"overflow-hidden",style:{width:149*m,height:241*m},children:(0,r.jsx)(k.r,{inventory:h.inventory,model:h.model,headIndex:h.headIndex||0})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center gap-4",children:[(0,r.jsx)("input",{className:"h-8 w-full p-2 dark:bg-gray-800",value:h.name,onChange:function(e){return a(e.target.value)}}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(p.z,{className:"px-6 py-1",onClick:t,children:f("Saves.buttonSave")}),(0,r.jsx)(p.z,{className:"px-6 py-1",onClick:l,children:f("Saves.buttonLoad")})]})]}),(0,r.jsx)("div",{className:"flex flex-col items-end justify-start w-16 p-2",children:(0,r.jsx)("img",{className:"w-12 cursor-pointer",src:"/delete_FILL0_wght400_GRAD0_opsz40.svg",onClick:o})})]})},F=function(e){var n=e.onNew,t=(0,w.ql)().t,i=(0,s.useContext)(d.Q).scale;return(0,r.jsx)("div",{className:"w-full h-40 flex flex-row items-center cursor-pointer bg-panel justify-center",style:{height:241*i},onClick:n,children:(0,r.jsxs)("span",{className:"text-3xl font-bold",children:["+ ",t("Saves.newSave")]})})},W=function(e){var n=e.onClose,t=(0,w.ql)().t,l=(0,s.useContext)(i.p).items,o=(0,s.useContext)(y.e4),a=o.headIndex,d=o.setHeadIndex,p=o.model,k=o.setModel,S=(0,C.BC)(function(e){return e.inventory}),_=(0,C.sl)(),I=(0,c._)((0,s.useState)(),2),M=I[0],L=I[1],z=(0,c._)((0,s.useState)(),2),D=z[0],T=z[1];(0,s.useEffect)(function(){var e;(e=(0,u._)(function(){var e;return(0,h.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,U.IB)()];case 1:return L(n.sent()),[3,3];case 2:return e=n.sent(),alert("Failed to load saves: "+e.message),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)})()},[]),(0,b.q)(function(){void 0===D&&n()});var W=function(e){L(e);try{(0,U.fF)(e)}catch(e){alert("Failed to persist saves")}},q=function(e){if(void 0!==M){var n=P({id:e.id,name:e.name,inventory:S,model:p,headIndex:a});T({title:t("Saves.confirmOverwriteTitle"),message:t("Saves.confirmOverwriteMessage",{name:e.name}),onConfirm:function(){W(M.map(function(t){return t.id===e.id?n:t})),T(void 0)},onCancel:function(){T(void 0)}})}},O=function(e){T({title:t("Saves.confirmLoadTitle"),message:t("Saves.confirmLoadMessage",{name:e.name}),onConfirm:function(){var t=E(e,l);_((0,N.cW)(t.inventory)),k(t.model),t.headIndex&&d(t.headIndex),n(),T(void 0)},onCancel:function(){T(void 0)}})},R=function(e){void 0!==M&&T({title:t("Saves.confirmDeleteTitle"),message:t("Saves.confirmDeleteMessage",{name:e.name}),onConfirm:function(){W(M.filter(function(n){return n.id!==e.id})),T(void 0)},onCancel:function(){T(void 0)}})},H=function(e,n){void 0!==M&&W(M.map(function(t){return t.id===e.id?(0,m._)((0,f._)({},t),{name:n}):t}))};return(0,r.jsxs)(j.u,{onDismiss:n,noScroll:!0,children:[(0,r.jsxs)("div",{className:"w-full h-full bg-itemList flex flex-col border border-black",children:[(0,r.jsxs)("div",{className:"w-full flex flex-row items-center justify-between border-b border-black",children:[(0,r.jsx)("div",{className:"w-12 h-12"}),(0,r.jsx)("span",{className:"text-xl font-bold",children:t("Saves.savedCharacters")}),(0,r.jsx)("div",{className:"flex items-cetner justify-center w-12 h-12 p-2 cursor-pointer",onClick:n,children:(0,r.jsx)("img",{src:"/close_400_black.svg"})})]}),void 0===M?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xl font-bold",children:"Loading"})}):(0,r.jsxs)("div",{className:"flex-1 grid grid-cols-2 auto-rows-min gap-4 overflow-y-scroll overflow-x-hidden p-4",children:[M.map(function(e){return(0,r.jsx)(Z,{save:e,onSave:function(){return q(e)},onLoad:function(){return O(e)},onDelete:function(){return R(e)},onRename:function(n){return H(e,n)}},e.id)}),(0,r.jsx)(F,{onNew:function(){if(void 0!==M){var e=P({id:(0,v.x0)(),name:"New save",inventory:S,model:p,headIndex:a});W((0,x._)(M).concat([e]))}}})]})]}),D&&(0,r.jsx)(g,(0,f._)({},D))]})},q=t(29733),O=t(31955),R="LAST_SEEN_UPDATE",H=function(){var e=(0,c._)((0,s.useState)(function(){return O.Z.get(R)||new Date().toISOString()}),2),n=e[0],t=e[1];return(0,s.useEffect)(function(){n&&O.Z.set(R,n)},[n]),[n,t]},A=t(54148),B=function(){var e=(0,s.useContext)(a.P),n=e.hand,t=e.setHand,i=e.setHoverableCells,l=e.hoveredCell,o=(0,c._)((0,s.useState)(!1),2),d=o[0],u=o[1],f=(0,s.useId)();(0,s.useEffect)(function(){i(function(e){return(0,x._)(e).concat([f])})},[]);var m=(0,s.useCallback)(function(e){f===e.detail&&t(void 0)},[f,n]);return((0,s.useEffect)(function(){return document.addEventListener("celldrop",m),function(){document.removeEventListener("celldrop",m)}}),void 0===n)?null:(0,r.jsx)("div",{id:f,className:"h-full w-full flex-1 absolute top-0 left-0 bg-[#56574688] flex items-center justify-center cursor-pointer",onClick:function(){t(void 0)},onMouseEnter:function(){return u(!0)},onMouseLeave:function(){return u(!1)},children:(0,r.jsx)(A.Z,{htmlColor:"#fff",sx:{fontSize:d||l===f?200:160}})})},Q=t(33264),Y=function(){var e=(0,s.useContext)(y.e4).selectedItemType,n=(0,s.useContext)(i.p).categories,t=(0,s.useContext)(a.P),o=t.hand,c=t.setHand,u=(0,s.useContext)(d.Q).scale,f=e&&n.flatMap(function(e){return e.types}).find(function(n){return n.id===e.typeId});return(0,r.jsx)("div",{className:"h-full flex-1 flex flex-col bg-itemList",style:{maxWidth:(0,l.T)()?void 0:508*u,minWidth:120},children:(0,r.jsx)(Q.r,{size:(null==f?void 0:f.size)||"small",onItemTaken:function(e){void 0===o&&c(e)},selectedItemType:e,sourceScreen:"item_list"})})},V=function(){return(0,r.jsx)("div",{className:"h-full flex-1 flex flex-col bg-itemList  items-center justify-center",children:(0,r.jsx)("div",{className:"flex flex-col items-center",children:(0,r.jsx)("span",{className:"text-3xl",children:"Loading..."})})})},X=t(55819),G=t(80791),J=function(){var e=(0,s.useContext)(w.dn),n=e.currentLocale,t=e.setCurrentLocale,i=function(e){gtag("event","change_locale",{event_category:"locale",event_label:e}),t(e)};return(0,r.jsxs)(G.P,{className:"w-full",style:{height:30},value:n||"",onChange:function(e){return i(e)},children:[(0,r.jsx)(X.Z,{value:"en",children:"English"}),(0,r.jsx)(X.Z,{value:"ru",children:"Русский"}),(0,r.jsx)(X.Z,{value:"cn",children:"中文"}),(0,r.jsx)(X.Z,{value:"fr",children:"Fran\xe7ais"})]})},K=t(79917),$=t(34912),ee=t(27842),en=t(26760),et=function(e){var n=e.onClose,t=(0,c._)((0,ee.r)(),3),i=t[0],l=t[1],o=t[2],a=(0,en.v)(),d=a.darkMode,u=a.setDarkMode,x=(0,w.ql)().t,h=(0,c._)((0,s.useState)(),2),v=h[0],p=h[1];return(0,b.q)(function(){void 0!==v?p(void 0):n()}),(0,r.jsxs)(j.u,{noScroll:!0,onDismiss:n,children:[(0,r.jsxs)("div",{className:"w-full h-full bg-itemList flex flex-col border border-black",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-black",children:[(0,r.jsx)("div",{className:"w-12 h-12"}),(0,r.jsx)("span",{className:"text-xl font-bold",children:x("SettingsWindow.settings")}),(0,r.jsx)("div",{className:"flex items-cetner justofy-center w-12 h-12 p-2 cursor-pointer",onClick:n,children:(0,r.jsx)("img",{src:"/close_400_black.svg"})})]}),(0,r.jsxs)("div",{className:"flex flex-col flex-1 overflow-y-scroll p-2 gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("span",{className:"font-bold w-36",children:"Color scheme"}),(0,r.jsxs)(G.P,{className:"w-full",style:{height:30},value:d,onChange:function(e){return u(e)},children:[(0,r.jsx)(X.Z,{value:"system",children:"System default"}),(0,r.jsx)(X.Z,{value:"light",children:"Light"}),(0,r.jsx)(X.Z,{value:"dark",children:"Dark"})]})]}),(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("span",{className:"font-bold w-36",children:"Language"}),(0,r.jsx)(J,{})]}),!1===i&&l&&(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("span",{className:"font-bold w-36",children:"Weapon model"}),(0,r.jsxs)(G.P,{className:"w-full",style:{height:30},value:l.weaponModel,onChange:function(e){return o((0,m._)((0,f._)({},l),{weaponModel:e}))},children:[(0,r.jsx)(X.Z,{value:"model",children:"Default"}),(0,r.jsx)(X.Z,{value:"real",children:"Equipped weapon"}),(0,r.jsx)(X.Z,{value:"realShaded",children:"Shape of the equipped weapon"})]})]}),(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)("span",{className:"font-bold w-36",children:"Inventory template"}),(0,r.jsxs)(G.P,{className:"w-full",style:{height:30},value:l.inventoryTemplate||"innawoods",onChange:function(e){return o((0,m._)((0,f._)({},l),{inventoryTemplate:e}))},children:[(0,r.jsx)(X.Z,{value:"innawoods",children:"Default"}),(0,r.jsx)(X.Z,{value:"eft",children:"EFT"}),(0,r.jsx)(X.Z,{value:"metro",children:"Metro"})]})]})]}),(0,r.jsx)($.F,{onModClicked:p})]})]}),void 0!==v&&(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full lg:px-16 lg:py-8",children:(0,r.jsx)(K.u,{mod:v,onClose:function(){return p(void 0)}})})]})},er=function(){return(0,r.jsx)("a",{href:"https://discord.gg/cDgfGkM4wT",target:"_blank",rel:"noopener noreferrer",className:"rounded border border-black p-2 text-sm bg-[#5865F2] hover:bg-[#4f5ad9] active:bg-[#4650c1] flex items-center justify-center",style:{height:40},children:(0,r.jsx)("img",{src:"/small_logo_white_RGB.png"})})},es=t(47674),ei=t(29895),el=t(30891),eo=t(94161),ea=t(12634),ec=t(46926),ed=t.n(ec),eu=t(61120),ef=t.n(eu),em=t(16233),ex=function(){var e,n,t=(0,w.ql)().t,i=(0,s.useContext)(d.Q).scale,o=(0,c._)((0,s.useState)(!1),2),a=o[0],f=o[1],m=(0,c._)((0,s.useState)(),2),x=m[0],v=m[1],g=(0,c._)((0,s.useState)(!1),2),y=g[0],N=g[1],k=(0,c._)((0,s.useState)(1),2),C=k[0];k[1];var S=(0,s.useRef)(null);(0,s.useEffect)(function(){if(a&&null!==S.current){var e,n=S.current.getPanelRef().current,t=S.current.getCharacterModelRef().current;null!==n&&null!==t&&(e=y?t:n,"ios"===ei.dV.getPlatform()?ef()(e,{scale:C/i,useCORS:!0,allowTaint:!0,scrollX:0,backgroundColor:"transparent",scrollY:0,windowWidth:0,windowHeight:0}).then(function(e){return e.toDataURL("image/png")}):ed().toPng(e,{copyDefaultStyles:!1,style:{overflow:"visible"}}).then(function(e){return e})).then(function(e){return v(e)})}},[S.current,y,a]),(0,b.q)(function(){return f(!1)});var _=function(){var e=new Date,n=[e.getFullYear().toString(),(e.getMonth()+1).toString().padStart(2,"0"),e.getDate().toString().padStart(2,"0"),e.getHours().toString().padStart(2,"0"),e.getMinutes().toString().padStart(2,"0"),e.getSeconds().toString().padStart(2,"0")].join("-");return"Innawoods_".concat(n,".png")},I=(e=(0,u._)(function(){var e,n;return(0,h.Jh)(this,function(t){switch(t.label){case 0:if(void 0===x)return alert("Image is not ready yet"),[2];return e=_(),[4,el.fy.writeFile({path:e,data:x,directory:el.tP.Cache})];case 1:return t.sent(),[4,el.fy.getUri({directory:el.tP.Cache,path:e})];case 2:return n=t.sent(),[4,eo.m.share({title:e,text:e,url:n.uri})];case 3:return t.sent(),f(!1),[2]}})}),function(){return e.apply(this,arguments)}),M=(n=(0,u._)(function(){var e,n;return(0,h.Jh)(this,function(t){switch(t.label){case 0:if(void 0===x)return alert("Image is not ready yet"),[2];if("android"!==ei.dV.getPlatform())return[3,6];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,es.p.createAlbum({name:"Innawoods"})];case 2:case 3:return t.sent(),[3,4];case 4:return[4,es.p.getAlbums()];case 5:e=null===(n=t.sent().albums.find(function(e){return"Innawoods"===e.name}))||void 0===n?void 0:n.identifier,t.label=6;case 6:return[4,es.p.savePhoto({path:x,fileName:_(),albumIdentifier:e})];case 7:return t.sent(),f(!1),ea.F.show({text:"Image saved!"}),[2]}})}),function(){return n.apply(this,arguments)});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.z,{onClick:function(){gtag("event","save_image_clicked",{event_category:"inventory"}),f(!0)},children:t("SaveImage.saveImage")}),a&&(0,r.jsxs)(j.u,{onDismiss:function(){f(!1)},noScroll:!0,children:[(0,r.jsxs)("div",{className:"bg-itemList",style:{zIndex:1e3},children:[(0,r.jsx)("div",{className:"w-full h-full flex flex-col border-bottom border-black ",children:(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-black",children:[(0,r.jsx)("div",{className:"w-12 h-12"}),(0,r.jsx)("span",{className:"text-xl font-bold",children:t("SaveImage.saveImage")}),(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 p-2 cursor-pointer",onClick:function(){return f(!1)},children:(0,r.jsx)("img",{src:"/close_400_black.svg"})})]})}),(0,r.jsxs)("div",{className:"p-4 flex flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex flex-row justify-center",style:{width:340*i,height:325*i},children:(0,r.jsx)("img",{src:x})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,r.jsx)("input",{className:"w-10 h-10",type:"checkbox",checked:y,onChange:function(e){return N(e.target.checked)}}),(0,r.jsx)("span",{className:"text-xl",children:"Character model only"})]}),(0,l.v)()?(0,r.jsxs)("div",{className:"flex-1 flex flex-row justify-center items-center gap-4",children:[(0,r.jsx)(p.z,{onClick:M,children:"Save to Gallery"}),(0,r.jsx)(p.z,{onClick:I,children:"Share"})]}):(0,r.jsx)("div",{className:"flex-1 flex flex-row justify-center items-center gap-4",children:(0,r.jsx)(p.z,{onClick:function(){if(void 0===x){alert("Image is not ready yet");return}var e=document.createElement("a");e.download=_(),e.href=x,e.click(),f(!1)},children:"Save image"})})]})]})]}),(0,r.jsx)("div",{className:"absolute left-[-9999px] top-[-9999px]",children:(0,r.jsx)(d.Q.Provider,{value:{scale:1,isSavingImage:!0},children:(0,r.jsx)(em.N,{ref:S})})})]})]})},eh=t(64022),ev=function(e){var n=e.onShowSavesClicked,t=e.onShowUpdatesClicked,i=e.onShowSettingsClicked,o=(0,w.ql)().t,a=(0,C.sl)(),d=(0,s.useContext)(y.e4),u=d.selectedItemType,m=d.setSelectedItemType,x=(0,s.useContext)(y.e4).setModel,h=(0,c._)((0,s.useState)(),2),v=h[0],b=h[1];return(0,r.jsxs)("div",{className:"h-full flex flex-col shrink-0 overflow-y-scroll overflow-x-hidden bg-itemList  border-l border-black w-[140px]",style:{width:(0,l.v)()?130:void 0},children:[(0,r.jsxs)("div",{className:"flex flex-col p-1 gap-1",children:[(0,r.jsx)(p.z,{onClick:function(){gtag("event","show_settings",{event_category:"inventory"}),i()},children:o("buttonSettings")}),(0,r.jsx)(er,{}),(0,r.jsx)(ex,{}),(0,r.jsx)(p.z,{onClick:function(){gtag("event","show_saves",{event_category:"inventory"}),n()},children:o("buttonSave")}),(0,r.jsx)(p.z,{onClick:function(){gtag("event","show_updates",{}),t()},children:o("updateHistory")}),(0,r.jsx)(p.z,{onClick:function(){b({title:o("clearInventory"),message:o("clearInventoryMessage"),onConfirm:function(){gtag("event","clear_inventory",{}),a((0,N.cW)(N.Lv)),x(_.CS),b(void 0)},onCancel:function(){return b(void 0)}})},children:o("clearInventory")})]}),(0,r.jsx)(eh.p,{selectedType:u,onTypeSelected:m}),v&&(0,r.jsx)(g,(0,f._)({},v))]})},ep=t(27036),eb=t(50594),ej=t(98456),eg=function(){var e=(0,s.useContext)(i.p).updateStatus,n=(0,c._)((0,s.useState)(!1),2),t=n[0],l=n[1];return(0,s.useEffect)(function(){"idle"===e?l(!1):"complete"===e||"error"===e?(l(!0),setTimeout(function(){l(!1)},3e3)):l(!0)},[e]),(0,r.jsx)("div",{className:"fixed bottom-4 w-full pointer-events-none flex flex-col items-center",children:(0,r.jsxs)("div",{className:"".concat(t?"opacity-100":"opacity-0"," transition-opacity duration-500 ease-in-out border border-black bg-button rounded py-2 px-3 flex flex-row justify-between gap-2"),children:["checking"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Checking for updates"}),(0,r.jsx)(ej.Z,{size:24})]}),"downloading"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Downloading updates"}),(0,r.jsx)(ej.Z,{size:24})]}),"updating"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Updating"}),(0,r.jsx)(ej.Z,{size:24})]}),"complete"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Your app is up-to-date"}),(0,r.jsx)(ep.Z,{className:"w-6 h-6 text-blue-500"})]}),"error"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Failed to update"}),(0,r.jsx)(eb.Z,{className:"w-6 h-6 text-red-500"})]})]})})},ew=function(){var e=(0,s.useContext)(i.p),n=e.items,t=e.updates,o=e.isLoading,a=(0,c._)((0,s.useState)(!1),2),u=a[0],f=a[1],m=(0,c._)((0,s.useState)(!1),2),x=m[0],h=m[1],v=(0,c._)(H(),2),p=v[0],b=v[1],j=(0,c._)((0,ee.r)(),2),g=(j[0],j[1]),w=t.filter(function(e){return u||e.date>p}).sort(function(e,n){return new Date(n.date).getTime()-new Date(e.date).getTime()}),y=(0,c._)((0,s.useState)(!1),2),N=y[0],k=y[1],C=(0,s.useContext)(d.Q).scale,S=(null==g?void 0:g.inventoryTemplate)||"innawoods";return(0,r.jsxs)("div",{className:"flex flex-row select-none justify-center items-center grow bg-black",style:{height:(0,l.v)()?"100vh":(0,em.b)(S).height*C},children:[(0,r.jsx)(em.N,{}),(0,r.jsx)("div",{className:"h-full flex flex-row relative justify-center items-center grow",style:{maxWidth:(0,l.T)()?void 0:648*C},children:o?(0,r.jsx)(V,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{}),(0,r.jsx)(ev,{onShowSettingsClicked:function(){return h(!0)},onShowSavesClicked:function(){return k(!0)},onShowUpdatesClicked:function(){return f(!0)}}),(0,r.jsx)(B,{})]})}),w&&w.length>0?(0,r.jsx)(q.X,{items:n,updates:w,onClose:function(){var e=w&&w[0];e&&b(e.date),f(!1)}}):null,N&&(0,r.jsx)(W,{onClose:function(){return k(!1)}}),x&&(0,r.jsx)(et,{onClose:function(){return h(!1)}}),(0,l.v)()&&(0,r.jsx)(eg,{})]})},ey=function(){var e=(0,s.useContext)(i.p).categories,n=(0,s.useContext)(y.e4),t=n.selectedItemType,c=n.setSelectedItemType,d=(0,s.useContext)(a.P),u=d.hand,f=d.setHand,m=d.hoveredCell,x=(d.hoverableCells,d.setHoveredCell);return(0,s.useEffect)(function(){void 0===t&&e.length>0&&c({typeId:e[0].types[0].id})},[t,e,c]),(0,r.jsxs)("div",{className:"no-select ".concat((0,l.v)()?"":"custom-scrollbars select-none"),style:{WebkitTapHighlightColor:"transparent"},onContextMenu:function(e){e.preventDefault(),!(0,l.T)()&&u&&f(void 0)},onPointerUp:function(e){(0,l.T)()&&(u&&m?(document.dispatchEvent(new CustomEvent("celldrop",{detail:m})),x(void 0)):(console.debug("unset hand"),f(void 0)))},children:[(0,r.jsx)(ew,{}),(0,r.jsx)(o.P,{item:u})]})}},79917:function(e,n,t){t.d(n,{u:function(){return c}});var r=t(85893),s=t(32807),i=t(67294),l=t(7935),o=t(59734),a=t(87967),c=function(e){var n=e.mod,t=e.onClose,c=e.onItemClicked,d=(0,o.ZP)("".concat(n.url,"?q=").concat(new Date(n.updatedAt).getTime()),a._i,{revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1}),u=d.data;d.error,d.isLoading;var f=(0,s.ql)(),m=f.t,x=f.getTranslation,h=(0,i.useContext)(l.p).categories.flatMap(function(e){return e.types});return(0,r.jsxs)("div",{className:"w-full h-full bg-itemList flex flex-col border border-black",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-black",children:[(0,r.jsx)("div",{className:"w-12 h-12"}),(0,r.jsx)("span",{className:"text-xl font-bold",children:n.name}),(0,r.jsx)("div",{className:"flex items-cetner justofy-center w-12 h-12 p-2 cursor-pointer",onClick:t,children:(0,r.jsx)("img",{src:"/close_400_black.svg"})})]}),(0,r.jsx)("div",{className:"overflow-y-scroll flex flex-col px-2 lg:px-4 py-2",children:(0,r.jsxs)("table",{className:"table-fixed border border-black mt-2",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-panel",children:[(0,r.jsx)("th",{className:"border border-black"}),(0,r.jsx)("th",{className:"border border-black",children:m("UpdateWindow.name")}),(0,r.jsx)("th",{className:"border border-black",children:m("UpdateWindow.author")}),(0,r.jsx)("th",{className:"border border-black",children:m("UpdateWindow.type")})]})}),(0,r.jsx)("tbody",{children:(u||[]).map(function(e){var n;return(0,r.jsxs)("tr",{onClick:function(){return null==c?void 0:c(e)},className:"".concat(c?"cursor-pointer":""),children:[(0,r.jsx)("td",{className:"border border-black w-64 h-[90px]",children:(0,r.jsx)("div",{className:"min-w-[120px] flex items-center justify-center p-1",children:(0,r.jsx)("img",{src:e.icon.image})})}),(0,r.jsx)("td",{className:"border border-black p-2",children:x(e.name)}),(0,r.jsx)("td",{className:"border border-black p-2 w-48",children:e.author}),(0,r.jsx)("td",{className:"border border-black p-2 w-32",children:x(null===(n=h.find(function(n){return n.id===e.typeId}))||void 0===n?void 0:n.name)})]},e.id)})})]})})]})}},34912:function(e,n,t){t.d(n,{F:function(){return f}});var r=t(24043),s=t(85893),i=t(18726),l=t(67294),o=t(53852),a=t(32807),c=t(11163),d=t(93946),u=t(50594),f=function(e){var n=e.onModClicked,t=e.asPicker,f=(0,a.ql)().t,x=(0,c.useRouter)(),h=(0,l.useContext)(o.V),v=h.enabledMods,p=h.setModEnabled,b=(0,r._)((0,l.useState)(""),2),j=b[0],g=b[1];if(void 0===v)return null;var w=null==v?void 0:v.none(function(e){return!e.enabled}),y=v.filter(function(e){return e.name.toLowerCase().includes(j.toLowerCase())||e.authorName.toLowerCase().includes(j.toLowerCase())});return(0,s.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,s.jsxs)("div",{className:"mt-4 flex flex-row justify-between gap-2 items-center",children:[(0,s.jsx)("span",{className:"font-bold",children:f("SettingsWindow.Mods.title")}),(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)("input",{className:" w-full h-10 bg-transparent rounded ",placeholder:"Search",type:"text",value:j,onChange:function(e){return g(e.target.value)}}),(0,s.jsx)("div",{className:"absolute right-0 top-0",children:(0,s.jsx)(d.Z,{onClick:function(){return g("")},children:(0,s.jsx)(u.Z,{})})})]}),!t&&(0,s.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,s.jsx)(i.w,{className:"w-24",type:"secondary",onClick:function(){var e=!w;null==v||v.forEach(function(n){p(n.id,e)})},children:f(w?"SettingsWindow.Mods.buttonDisableAll":"SettingsWindow.Mods.buttonEnableAll")}),(0,s.jsx)(i.w,{onClick:function(){return x.push("/mods")},children:f("SettingsWindow.Mods.buttonCreateNew")})]})]}),y.map(function(e){return(0,s.jsx)(m,{mod:e,onClick:function(){return n(e)},enabled:e.enabled,onEnabledChanged:function(n){return p(e.id,n)},asPicker:t},e.id)})]})},m=function(e){var n=e.mod,t=e.enabled,r=e.onEnabledChanged,i=e.onClick,o=e.asPicker,a=(0,l.useRef)(null);return(0,s.jsxs)("div",{className:"flex flex-row items-center border border-black rounded py-1 px-2 cursor-pointer",onClick:function(e){e.target!==a.current&&i()},children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-1 items-end",children:[(0,s.jsx)("span",{className:"text-xl",children:n.name}),(0,s.jsxs)("span",{className:"text-sm",children:["by ",n.authorName]})]}),(0,s.jsx)("p",{className:"line-clamp-6",children:n.description})]}),!o&&(0,s.jsx)("input",{className:"ml-auto w-10 h-10",ref:a,type:"checkbox",checked:t,onChange:function(e){r(e.target.checked)}})]})}},29733:function(e,n,t){t.d(n,{X:function(){return x}});var r=t(72253),s=t(14932),i=t(248),l=t(85893),o=t(32807),a=t(81069),c=t(67294),d=t(7935),u=t(94760),f=t(97169),m=function(e){var n=e.items,t=e.date,i=(0,c.useContext)(d.p).categories,a=(0,o.ql)(),u=a.getTranslation,f=a.t,m=i.flatMap(function(e){return e.types}).map(function(e){return e.id}),x=n.map(function(e){return(0,s._)((0,r._)({},e),{type:i.flatMap(function(e){return e.types}).find(function(n){return n.id===e.typeId})})}).sort(function(e,n){return m.indexOf(e.typeId)-m.indexOf(n.typeId)});return(0,l.jsxs)("div",{className:"flex flex-col px-2 lg:px-4 py-2",children:[(0,l.jsx)("p",{className:"font-bold",children:t}),(0,l.jsxs)("table",{className:"table-fixed border border-black mt-2",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-panel",children:[(0,l.jsx)("th",{className:"border border-black"}),(0,l.jsx)("th",{className:"border border-black",children:f("UpdateWindow.name")}),(0,l.jsx)("th",{className:"border border-black",children:f("UpdateWindow.author")}),(0,l.jsx)("th",{className:"border border-black",children:f("UpdateWindow.type")})]})}),(0,l.jsx)("tbody",{children:x.map(function(e){return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border border-black w-64 h-[90px]",children:(0,l.jsx)("div",{className:"min-w-[120px] flex items-center justify-center p-1",children:(0,l.jsx)("img",{src:e.icon.image})})}),(0,l.jsx)("td",{className:"border border-black p-2",children:u(e.name)}),(0,l.jsx)("td",{className:"border border-black p-2 w-48",children:e.author}),(0,l.jsx)("td",{className:"border border-black p-2 w-32",children:u(e.type.name)})]},e.id)})})]})]})},x=function(e){var n=e.updates,t=e.items,r=e.onClose,s=e.title;(0,c.useContext)(u.Q).scale;var d=(0,o.ql)().t,x=[];return n.forEach(function(e){var n,r=new Date(e.date).toLocaleDateString(),s=e.items.filter(function(e){return t.some(function(n){return n.id===e.id})}).map(function(e){return t.find(function(n){return n.id===e.id})}),l=x.findIndex(function(e){return e.date===r});l>-1?(n=x[l].items).push.apply(n,(0,i._)(s)):x.push({date:r,items:(0,i._)(s)})}),(0,a.q)(r),(0,l.jsx)(f.u,{onDismiss:r,noScroll:!0,children:(0,l.jsxs)("div",{className:"w-full h-full bg-itemList flex flex-col border border-black",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-black",children:[(0,l.jsx)("div",{className:"w-12 h-12"}),(0,l.jsx)("span",{className:"text-xl font-bold",children:s||d("UpdateWindow.newAdditions")}),(0,l.jsx)("div",{className:"flex items-cetner justofy-center w-12 h-12 p-2 cursor-pointer",onClick:r,children:(0,l.jsx)("img",{src:"/close_400_black.svg"})})]}),(0,l.jsx)("div",{className:"overflow-y-scroll",children:x.map(function(e,n){return(0,l.jsx)(m,{items:e.items,date:e.date},"update-".concat(n))})})]})})}},26760:function(e,n,t){t.d(n,{W:function(){return a},v:function(){return c}});var r=t(24043),s=t(85893),i=t(98396),l=t(67294),o=l.createContext({darkMode:"system",setDarkMode:function(){}}),a=function(e){var n=e.children,t=(0,r._)((0,l.useState)("light"),2),a=t[0],c=t[1],d=(0,i.Z)("(prefers-color-scheme: dark)");return(0,l.useEffect)(function(){var e=localStorage.getItem("darkMode");null!==e&&c(e)},[]),(0,l.useEffect)(function(){return"dark"===a||"system"===a&&d?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),function(){document.documentElement.classList.remove("dark")}},[d,a]),(0,s.jsx)(o.Provider,{value:{darkMode:a,setDarkMode:function(e){localStorage.setItem("darkMode",e),c(e)}},children:n})},c=function(){var e=l.useContext(o);return{darkMode:e.darkMode,setDarkMode:e.setDarkMode}}}}]);